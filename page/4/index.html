<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-技术整理/前端" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/28/技术整理/前端/" class="article-date">
  <time datetime="2017-11-28T08:26:16.000Z" itemprop="datePublished">2017-11-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>localStrage是用变量只能写不能读<br>opacity: 0;<br>浏览器加入历史记录，只有加入锚点不会刷新界面，其他都会<br>window.onstatechange=window.onload<br>或者通过history.pushstate，手动请求 window.onpopstate</p>
<p>put delete方法,传输文件<br>head获取报文首部,不要内容<br>options:询问支持什么方法</p>
<p>204 no content 请求处理成功,但没有返回,用于客户端向服务器发送信息<br>206 服务器响应客户端的部分请求 content-range<br>301 资源uri已更新,永久性重定向<br>302 临时重定向<br>303 临时重定向,客户端使用get方法<br>返回301 302 303都需要改用get方法<br>304 发送带条件请求,但是条件不符合<br>307 同302</p>
<p>400 客户端语法错误<br>401 需要认证或认证失败 unauthorized<br>403 拒绝访问 forbidden<br>404 没有该资源<br>500 服务器错误<br>503 服务器负载或停机</p>
<p>一台服务器使用虚拟主机可以提供多个域名的访问,host内必须指定uri<br>代理服务器<br>缓存服务器确保缓存资源的有效性</p>
<p>pragma:no-cache</p>
<p>content-type:text/html 报文主体对象类型<br>cache-control请求方有no-cache不缓存过期的资源,no-store不缓存<br>响应方有public所有人,private特定用户,可省略<br>s-maxage:忽略maxage,对多位用户使用的公共缓存器 缓存时间秒<br>max-age:缓存期没有超过发给的时间则请求缓存<br>min-fresh:过了该数值的资源都不能返回了<br>max-stale:接受过期的资源<br>revalidate会验证缓存的有效性<br>缓存扩展</p>
<p>connection:keep-alive  close<br>date:报文创建时间<br>via:代理服务器</p>
<p>请求首部字段:<br>accept:给我发某种格式的<br>text/html,text/xml,image/jpeg,q为权重值<br>accept-charset:返回这个字符集<br>accept-encoding:想要哪种编码的  gzip,deflate<br>accept-language:想要哪种语言的<br>authorization<br>from电子邮箱</p>
<p>虚拟主机运行在一个ip上,因此需要head中添加host来区分<br>if和etag<br>proxy-authorization<br>range<br>user-agent:用户代理,平板,手机</p>
<p>返回值<br>age表示多久前创建了响应<br>etag每份资源<br>location配合3xx<br>retry-after:多少时间后在来访问 3xx  503<br>server:服务器上安装的http程序信息<br>vary:</p>
<p>实体:<br>allow:允许的方法<br>content-language<br>content-length<br>content-md5  无法判断篡改<br>expires:该资源你可以用到什么时间<br>last-modified:上一次修改的时间</p>
<p>set-cookie和cookie<br>dnt:拒绝收集个人信息</p>
<p>http加密正文内容或是https<br>双方身份的认证,证书,uid<br>下载文件提供md5,以判断文件是否被篡改</p>
<p>https提供了这3种的保护,加密,认证,完整性保护<br>http和ssl通信,ssl和tcp通信<br>别的应用层也可以用ssl<br>算法公开,密钥私密,非对称密钥,公开密钥和私密密钥<br>openssl自认证</p>
<p>敏感信息才用https,费用购买证书的<br>xss攻击:跨站脚本攻击,js代码<br>sql注入<br>os注入攻击比如发送邮件<br>php报错提示黑客</p>
<p>彩虹表就是散列函数8位</p>
<p>index是点击的时候取值，列表取值使用eq<br>比如现在有这么一个规律，hr是一段文章开始标志，我取出所有的hr，然后取每个hr后面的第一个p前4个字作为标题</p>
<p>fetch需要promise的支持，uc<br>使用size和srcset实现图片的按设备加载，不支持ie或者picture和souce结合media</p>
<p>clear:left是位于浮动元素右边或者下边<br>不clear就在右边或下边</p>
<p>因此解决方案是利用支持的属性如：opacity: 0 或者 width:0, height:0 或者 visibility:hidden 来达到视觉上的隐藏效果。</p>
<p>如果目标元素中有链接之类那么推荐用visibility而不是opacity,因为opacity为0时链接仍可以被点击。</p>
<p>filter:alpha(opacity=40); /<em> For IE8 and earlier </em>/<br>css图像精灵就是图片拼合，必须限制背景的区域<br>background-origin:content-box;指定图片从哪里开始</p>
<p>响应式图片<br>img {<br>    max-width: 100%;<br>    height: auto;<br>}</p>
<p>表单焦点是outline，去表单样式，列表链接样式，还有边距<br>两个表单间距是回车引起的<br>还有inline-block有4个字符缩进<br>2个input间距合并</p>
<p>在函数外声明的变量是全局变量，网页上的所有脚本和函数都能访问它<br>如果您把值赋给尚未声明的变量，该变量将被自动作为全局变量声明</p>
<p>不包括工具栏和滚动条<br>var w=window.innerWidth|| document.documentElement.clientWidth|| document.body.clientWidth;</p>
<p>function myFunction()<br>{<br> $(“p”).click(function(){<br>    $(this).hide();<br>  });<br>$(“#h01”).attr(“style”,”color:red”).html(“Hello jQuery”)<br>}<br>$(“p”).css(“background-color”,”red”);</p>
<p>动画队列<br>  div.animate({height:’300px’,opacity:’0.4’},”slow”);<br>  div.animate({width:’300px’,opacity:’0.8’},”slow”);<br>  div.animate({height:’100px’,opacity:’0.4’},”slow”);<br>  div.animate({width:’100px’,opacity:’0.8’},”slow”);</p>
<p>  下面的例子把 <div> 元素移动到右边，然后增加文本的字号：<br>  $(“button”).click(function(){<br>  var div=$(“div”);<br>  div.animate({left:’100px’},”slow”);<br>  div.animate({fontSize:’3em’},”slow”);<br>});</div></p>
<p>模拟手机的网络环境，2g，gps，和禁用缓存<br>叹号，没执行，往下看看那里覆盖了<br>设置mobile-touch与否执行的事件不一样<br>sourse中点击大括号可以把合并压缩的代码复原<br>js代码里面加上debuger自动断点<br>console.error();</p>
<p>侧边栏固定,是监听滚动事件，然后判断改变css样式，左侧目录固定，不能超过尾<br>图片墙：图片堆叠，有不规则的旋转角度，绝对定位，彼此交叉，鼠标移过z-index,正并放大</p>
<p>阅读源码：从执行顺序入手，适当忽略细节<br>muse，edge animation cc  flash</p>
<p>没有任何边框 srcdoc 指定文字，覆盖src  sandbox禁止提交表单 禁止运行js 异源，有4个选项</p>
<iframe seamless srcdoc="string">

<p>引入zepto框架，用tap代替click<br>tap原理 touchstart touchmove touchend<br>从触摸到离开时间间隔短，起点终点距离小</p>
<p>$e.on(“tap”,function(){<br>    var target=e.target;<br>    target.addClass(“active”);<br>    setTimeOut(function(){<br>    target.removeClass(“active”);<br>    },150);<br>})</p>
<p>全局滚动：body上<br>局部滚动：某个dom<br>安卓使用全局滚动，滚动条不错位<br>给固定头尾的加个padding<br>patter=”[0-9]”<br>全数字键盘</p>
<p>search加个form 阻止onsubmit的默认行为<br>行内元素水平居中是给父元素设置text-align<br>定宽的块元素居中使用width margin：0 auto<br>不定宽块元素居中：改为行元素，或者position：relative left：-50%</p>
<p>高度确定的单行文本居中，高度和行高一致<br>float和absolute会自动变为inline-block</p>
<p>seo层级结构简单些，控制链接数量，面包屑<br>a rel=noflow不用爬了<br>表格的caption<br>重要的html内容放前面</p>
<p>层叠顺序，布局，内容   文字后来居上<br>定位元素会覆盖普通元素相当于z-index auto</p>
<p>border-collapse: collapse是表格的属性<br>合并边框先用去掉一边<br>父子同时出现：overflow：hidden</p>
<p>去动画  mContentListView.setItemAnimator(null);<br>sublime先保存文件才可以用emmet<br>prettify 右键 格式化代码<br>spacegray  主题把大括号去了就可以了，json格式的</p>
<p>./表示当前路径<br>../上一级路径</p>
<p>font使用百分比，不是具体的px，相对属性<br>阅读背景色和文字色<br>文字间距，行距，缩进</p>
<p>操作真实dom加上ref，然后使用ReactDom.findDOMNode(this.refs.xxx).value<br>把defaultValue当作初始值<br>表单的value和事件都用变量</p>
<p>函数复用bind name 和初始值key是一样的，一个函数处理所有表单事件<br>e.target.name   e.target.value   e.target.checked</p>
<p>父组件通过props传递给子组件，子组件通过事件传递给父组件，委托和属性<br>逻辑相同来源不同使用bind<br>子组件的事件使用this.props.handleChange,体哦啊用父元素的事件，委托出去<br>mixin，横向提取相似代码，面向切面，插件，即插即用<br>面向对象是纵向垂直提取</p>
<p>全局性的* { box-sizing: border-box; }就非常不错<br>简洁属性合并写法<br>居中：top: calc(50% - 10px);<br>视图转换优于动画。除了opacity 和transform，避免动画其他属性。</p>
<p>性能优化react 列表加key 父组件更新默认触发所有子组件更新<br>自组建覆盖should方法自行决定是否更新</p>
<p>requestAnimationFrame，js模拟动画实现css的效果,优化后的效果，多个一起做，保证时间一致，平滑</p>
<p>list和datalist使用display=none<br>check的indeterminate属性，不明确</p>
<p>valueAsNumber做计算器<br>颜色选择器设置背景style的颜色<br>range配合output使用<br>progress使用setInterval方法<br>meter表示状态有样式的，min，max，low，hight，opm</p>
<p>js事件直接把自己this传过去就不用getElementById了，直接innerHtml就行了</p>
<p>onselect选中文字事件<br>onchange是内容变了，不是实时</p>
<p>css属性继承，自body<br>零级事件是写button.onclick=function(){}<br>可以添加多个事件，按添加顺序来<br>true为拦截，false为冒泡<br>event.target  type<br>阻止冒泡，阻止默认（链接）</p>
<p>word_wrap换行，根据宽度来的<br>class可以设置多个类，样式需要.class.class<br>static对z-index和left,top这些无效<br>瀑布流通过column-width来实现</p>
<p>定义字体，格式<br>local，url，format（truetype）<br>font-size-adjust:0.6 修改字体保持字号不变 height/font-size</p>
<p>inline-block和inline展现相同,却可以设置宽度，inline不能设置宽度</p>
<p>inlinetable形成中间夹着表格，不是上下<br>div display list-item 变成了列表</p>
<p>文字左右滑<br>overflow-x:scroll<br>overflow-y:hidden<br>white-wrap:nowrap</p>
<p>box-sizing：content-box或border-box 宽高包括padding与否<br>background-clip background-origin 一样，都是位置从哪</p>
<p>backgroun-image多个url一起使用，后面的repeat属性，position依次写<br>border-image9文件，4个参数，4个高度</p>
<p>document.body.offsetWidth 不包括滚动条<br>windows.innerHeight 宽高<br>window。open(“.html”,”windowname”,”height=200,width=200,top=100,left=100”)</p>
<p>dataTransfer.files[0],使用filereader</p>
<p>清除浮动的几种方式，各自的优缺点<br>1.使用空标签清除浮动 clear:both（理论上能清楚任何标签，，，增加无意义的标签）<br>2.使用overflow:auto（空标签元素清除浮动而不得不增加无意代码的弊端,,使用zoom:1用于兼容IE）<br>3.是用afert伪元素清除浮动(用于非IE浏览器)</p>
<p>设定width和margin 0 auto居中，拉小有问题<br>在这种情况下使用 max-width 替代 width 可以使浏览器更好地处理小窗口的情况</p>
<p>box-sizing: border-box;<br>此时元素的内边距和边框不再会增加它的宽度，原来是向外缩，现在是向内缩</p>
<p>position是一种布局<br>relative 表现的和 static 一样，除非你添加了一些额外的属性。<br>四个方向值和margin不要混了，他们结合postion使用的<br>absolute是相对于最近的“positioned”祖先元素，同级的就要使用margin了</p>
<p>float是一种<br>图文环绕效果<br>clear之后就彼此分割了<br>浮动之后超过了父容器的大小，就需要添加overflow：auto</p>
<p>使用inline-block之后相关的就可以不用清除浮动了<br>inline-block:要设置宽度，空格回车这些会产生空隙，使用fontsize短暂解决</p>
<p>.three-column {<br>  padding: 1em;<br>  -moz-column-count: 3;<br>  -moz-column-gap: 1em;<br>  -webkit-column-count: 3;<br>  -webkit-column-gap: 1em;<br>  column-count: 3;<br>  column-gap: 1em;<br>}</p>
<p>这个比float强多了<br>.container {<br>  display: -webkit-flex;<br>  display: flex;<br>}<br>.initial {<br>    空间足够的时候，我的宽度是200px，如果空间不足，我会变窄到100px，但不会再窄了。<br>  -webkit-flex: initial;<br>          flex: initial;<br>  width: 200px;<br>  min-width: 100px;<br>}<br>.none {<br>  -webkit-flex: none;<br>          flex: none;<br>  width: 200px;<br>}<br>.flex1 {<br>    我会占满剩余宽度的1/3。<br>  -webkit-flex: 1;<br>          flex: 1;<br>}<br>.flex2 {<br>    我会占满剩余宽度的2/3。<br>  -webkit-flex: 2;<br>          flex: 2;<br>}</p>
<p>居中<br>.vertical-container {<br>  height: 300px;<br>  display: -webkit-flex;<br>  display:         flex;<br>  -webkit-align-items: center;<br>          align-items: center;<br>  -webkit-justify-content: center;<br>          justify-content: center;<br>}</p>
<pre><code>水平居中包含两种情况：
    块级元素的水平居中：margin:0px auto;
    文字内容的水平居中：text-align: center;

垂直居中：
    常见的单行文字的垂直居中可设置文字所在行的height与
    行高样式属性一致，比如：
    div{
        width: 400px;
        height: 400px;
        line-height: 400px;/*行高与div高度一致*/
    }
</code></pre><p>一个媒体查询实例，大屏幕下左侧导航，右边内容，小屏幕下列表置顶且横向</p>
<p>@media screen and (min-width:600px) {<br>  nav {<br>    float: left;<br>    width: 25%;<br>  }<br>  section {<br>    margin-left: 25%;<br>  }<br>}</p>
<p>@media screen and (max-width:599px) {<br>  nav li {<br>    display: inline;<br>  }<br>}</p>
<p>li img直接横向排列，不用float<br>通过背景图片来设置特殊效果，盒子3d模型，颜色下，图片上，叠加<br>不设置高度相当于wrapcontent</p>
<p>自动居中不要浮动 绝对定位<br>请详细观看盒子模型的立体图片，从第一层到第五层依次为：border、content+padding、background-image、background-color、margin。<br>float影响紧邻其后的元素，还有父元素，使用纵向排列的块级元素横向排列<br>父元素用width:100% + overflow:hidden<br>后面受影响的使用清除浮动除了clear:both还有</p>
<p>相对定位：相对自身原有位置偏移，仍处于文档流中<br>无侵入，不影响其他元素<br>margin-top和top不一样，前者影响后边（自定义拖拽）</p>
<p>绝对定位：脱离文档流，建立了以包含块为基准的定位<br>4个属性同时作用，relative是斗争，绝对是拉伸<br>设置绝对定位而没有宽度，则自适应</p>
<p>图片压缩，自动反编译<br>document.documentElement.srollTop||document.body.srollTop滚动条的数值</p>
<p>一图两用<br>background：url noreapet ；left top<br>background：url noreapet ；left -40px</p>
<p>css绘图标 border-radius r1 r2 w1 w4 分享 放大镜  file-icon<br>outline border 压在边框的效果<br>box-shadow  水平 垂直 距离 颜色<br>box-shadow  水平 垂直 距离 扩张 颜色;还可以接受列表，绘制n个边框投影  实现多重边框<br>向内挤压，不影响别的</p>
<p>渐变 位置和颜色 可以透明 多个<br>圆润的标签自己试试，径向渐变</p>
<p>绝对定位的z-index受父元素的影响<br>relative限制absolute的边距 层级 溢出  正常的overflow对绝对定位不影响，加了相对才有用</p>
<p>背景图片的repeat相当于9图片文件<br>@media only screen and (max-width:600px)（orientation:landscape|portrait）<br>在移动设备上面clear：both；<br>桌面设备上float：right；</p>
<p>关系数据库<br>设计数据库，ER模型图<br>多对多的采用关联表</p>
<p>添加mysql环境变量，类似git<br>cd D:\Soft\wamp\bin\mysql\mysql5.6.17\bin‘</p>
<p>mysql-u root-p 123456    使用用户登录有密码输入-p<br>设置中文<br>show variables like ‘char%’;<br>set character_set_database=’utf8’;<br>status；看4个都是utf8才行</p>
<p>show databases;<br>show tables;<br>describe user;显示详细信息，4位就够了<br>use 库/表</p>
<p>必须一开始就登陆进来<br>ERROR 1044 (42000): Access denied for user ‘’@’localhost’ to database<br>退出后mysql -u root -p</p>
<p>避免错误信息<br>drop database if exists nihao;</p>
<p> create table if not exists stu<br> (id char(6) not null primary key,<br> name char(8) not null,<br> age int(6) default 10,<br> sex tinyint(1) default 1);</p>
<p>临时表，复制结构<br>create temporary table if not exists user3 like stu;<br>复制内容<br>create table user4 as (select * from user);</p>
<p> alter table user4 rename to stu4;<br> alter table user4 add score int(6) after name;<br> alter table stu4 change score s int(8) not null;<br> alter table stu4 modify scores int(5) not null;<br> alter table stu4 modify sex int(6),drop column s;</p>
<p> 表明，列名，数据类型，长度，为空，默认值，约束，主键，外键<br> varchar，text，blob是可变的<br> char是4位以下</p>
<p> insert into stu set id=2,name=’zhangsan’,sex=1,age=21;<br> 替换<br> replace into stu values(1,’kj’,14,0),(2,’gv’,15,1) ;</p>
<p>load_file（路径）；存储图片<br>update stu set id=3,name=’bu’ where age=10;<br>delete from stu where name=’gv’;<br>联表更新，删除</p>
<p>drop是删除表<br>显示创建表的语句<br>show create table stu;</p>
<p>where不能用别名<br>select id as xuehao,name as ‘student name’,age as nianling from stu ;<br>select max(age),min(age) from stu;</p>
<p>.* 任意长度的字符串<br>^.+ 任一字符开头任意长度的字符串<br>.com$ 以.com结尾的字符串<br>global不能定义赋值一起，在函数里定义</p>
<p>mktime可以指定一个时间点(3,0,0,4,1,2016);<br>设置cookie的页面无法读取，离开才可以<br>要在php输出页面信息之前设置才有用</p>
<p>session_start();<br>_session[‘k’]=’v’;<br>PHPSESSIONID之前的问题，header的一个key而已<br>通过hidden传递sessionid<br>登录后用start，退出后用destroy</p>
<p>文件上传<br>post multpart<br>copy moveupload<br>大小限制<br>ini中的php配置file upload<br>file_upload=on<br>;表示注释，关闭<br>文件大小2M，8m<br>error 0-8 no 5<br>1 超过2M tmp_file为空了<br>2 超过表单max<br>3 部分上传<br>4 没有文件被上传<br>6 没有临时文件夹<br>7 写入失败</p>
<p>修改wmap的路径，根目录导致php不通</p>
<p>数组声明要指定长度或者这种int score[ ] = new int[ ] { 34, 90, 87, 54, 24 }在声明数组的同时赋值时不能指定数组长度</p>
<p>Arrays.sort(hobbys);<br>Arrays.toString(hobbys)输出数组nums中的元素：[25，7，126，53，14，86]<br>Math.random() 生成 0–1 的浮点数，乘以几</p>
<p>echo关键字与字符串之间至少要有一个空格<br>var_dump($string);<br>php变量的类型是可变的</p>
<p>在大连学习python<br>python通过缩进控制<br>自富春乘以10  str len<br>函数是def，：代替括号</p>
<p>入口<br>if <strong>name</strong> == ‘<strong>main</strong>‘:<br>    main()</p>
<p>def doQingan(myLine):<br>    print ‘gui’<br>    print ‘bai ‘ * 3<br>    print myLine</p>
<p>import sys<br>help(len)<br>print dir(sys)<br>help(sys.exit)<br>help(‘china’.split)<br>print dir(list)</p>
<p>a, b, c=(int(x) for x int raw_input().split(‘ ‘))<br>print a+b+c<br>print sum(int(x) for x in raw_input().split()) </p>
<p>&lt;?php<br>//首先采用“fopen”函数打开文件，得到返回值的就是资源类型。<br>$file_handle=fopen(“/data/webroot/resource/php/f.txt”,”r”);<br>if ($file_handle){<br>    //接着采用while循环（后面语言结构语句中的循环结构会详细介绍）一行行地读取文件，然后输出每行的文字<br>    while (!feof($file_handle)) { //判断是否到最后一行<br>        $line = fgets($file_handle); //读取一行文本<br>        echo $line; //输出一行文本<br>        echo “<br>“; //换行<br>    }<br>}<br>fclose($file_handle);//关闭文件<br>?&gt;</p>
<p>error_reporting(0); //禁止显示PHP警告提示<br>unset($var3);后就是null，只声明也是<br>mixed表示参数类型可以接受为多种不同的类型<br>$p = “PII”;<br>define($p,3.14);<br>define(“PI”,3.14);<br>define第一个参数是string<br>mixed constant(string constant_name)去常量值，动态的<br>$c=&amp;$a;取地址，后续a变了，c也会变<br>“!=”和”&lt;&gt;”都表示比较两个数的值而不必比较数据类型<br>$b.=”werasfasdf”; 字符串连加<br>错误信息在$php_errormsg里<br>$num = rand(1,50);//获取1至50的随机数<br>函数不能返回多个值，但可以通过返回一个数组来得到类似的效果。<br>list ($one, $two, $three) = numbers();<br>$name = ‘func’;//调用可变函数 $name(); 变量为函数的名字<br>function_exists  file_exists<br>if (class_exists(‘MyClass’)) {<br>    $myclass = new MyClass();<br>}<br>也可以用类名创建对象<br>    $classname=’Car’;<br>    $car2=new $classname();</p>
<p>echo $car-&gt;name;<br>在子类中如果定义了<strong>construct则不会调用父类的</strong>construct，如果需要同时调用父类的构造函数，需要使用parent::__construct()显式的调用，和java不一样</p>
<p>class Car {<br>    //增加构造函数与析构函数<br>    function __construct(){<br>        print “父类构造函数\n”;<br>    }</p>
<pre><code>function __destruct(){
        print &quot;父类析构函数\n&quot;;
}
</code></pre><p>}</p>
<p>class Car2 extends Car {<br>    //增加构造函数与析构函数<br>    function <strong>construct(){<br>        print “子类构造函数\n”;<br>        parent::</strong>construct();<br>    }</p>
<pre><code>function __destruct(){
        print &quot;子类析构函数\n&quot;;
}
</code></pre><p>}<br>$car = new Car();<br>$car1 = new Car2();</p>
<p>$func = ‘getSpeed’;<br>$className = ‘Car’;<br>echo $className::$func();  //动态调用静态方法</p>
<p>静态方法中，$this伪变量不允许使用。可以使用self，parent</p>
<p>class Car {<br>    private $ary = array();</p>
<pre><code>public function __set($key, $val) {
    $this-&gt;ary[$key] = $val;
}

public function __get($key) {
    if (isset($this-&gt;ary[$key])) {
        return $this-&gt;ary[$key];
    }
    return null;
}

public function __isset($key) {
    if (isset($this-&gt;ary[$key])) {
        return true;
    }
    return false;
}

public function __unset($key) {
    unset($this-&gt;ary[$key]);
}
</code></pre><p>}<br>$car = new Car();<br>$car-&gt;name = ‘汽车’;  //name属性动态创建并赋值<br>echo $car-&gt;name;</p>
<p>可以使用mb_strlen()函数获取字符串中中文长度<br>echo mb_strlen($str,”UTF8”);<br>$pos = strpos($str, ‘imooc’); indexOf<br>$replace = str_replace(‘js’, ‘php’, $str);</p>
<p>静态初始化块只在类加载时执行，且只会执行一次，同时静态初始化块只能给静态变量赋值，不能初始化普通的成员变量。</p>
<p>程序运行时静态初始化块最先被执行，然后执行普通初始化块，最后才执行构造方法。由于静态初始化块只在类加载时执行一次，所以当再次创建对象 hello2 时并未执行静态初始化块。</p>
<p>  // 初始化块，再创建一个实例时依然执行<br>    {<br>        System.out.println(“通过初始化块初始化sex”);<br>        sex = “男”;<br>    }</p>
<pre><code>// 静态初始化块
    static    { 
    System.out.println(&quot;通过静态初始化块初始化age&quot;);
    age = 20;
}
imooc为常量字符串，多次出现时会被编译器优化，只创建一个对象

文件后缀名判断
int index = fileName.lastIndexOf(&quot;.&quot;);
    if(index!=-1&amp;&amp;index!=0){     
    // 获取文件的后缀
    String prefix = fileName.substring(index+1);   }
    // 断必须包含&quot;.&quot;号，且不能出现在首位，同时后缀名为&quot;java&quot;
    if ( prefix.equals(&quot;java&quot;)) {
        System.out.println(&quot;Java文件名正确&quot;);
    } else {
        System.out.println(&quot;Java文件名无效&quot;);
    }

    // 获取邮箱中&quot;@&quot;符号的位置
    int index2 = email.charAt(&apos;@&apos;);

    // 获取邮箱中&quot;.&quot;号的位置
    int index3 = email.indexOf(&apos;.&apos;);

    // 判断必须包含&quot;@&quot;符号，且&quot;@&quot;必须在&quot;.&quot;之前
    if (index2 != -1 &amp;&amp; index3 != -1&amp;&amp; index2 &gt;0  &amp;&amp;index3 &gt;0 &amp;&amp; index3 &gt; index2) {
</code></pre><p>先创建父类对象，属性，构造函数<br>创建自类的时候也会创建父类，父类的属性和子类的无关，super调用即可；<br>创建了有参构造函数那么就不会自动生成一个空方法<br>final声明的变量，要在构造函数里面初始化</p>
</iframe>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/28/技术整理/前端/" data-id="cjajd03qi000udwll9h8n4siy" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-技术整理/待整理-手机卫士-设计模式-面试指南-graddle-as技巧" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/28/技术整理/待整理-手机卫士-设计模式-面试指南-graddle-as技巧/" class="article-date">
  <time datetime="2017-11-28T08:26:16.000Z" itemprop="datePublished">2017-11-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>手机卫士</p>
<p>splash有个时间差，通过handler计算，如果加载完了时间短则休眠2000-消耗时间，让动画走完<br>把配置信息放到一个xml文件或者一个统一的类里</p>
<p>熟悉gradle基本命令<br>熟悉产品设计和MD，如图文排列的设计，<br>做过类似手机卫士的功能，md5<br>读过源码<br>了解图片矩阵的知识</p>
<p>通过拨号进入一个程序界面<br>通过TelephonyManager获取sim串号，不同了则是设备sim更换了，注册重启广播<br>SmsReceiver收到短信有广播</p>
<pre><code>DevicePolicyManager devicePolicyManager;
devicePolicyManager.wipeData(0); 清除数据
devicePolicyManager.lockNow(); 远程锁屏
</code></pre><p>TelephonyManager.listen(listerner);</p>
<p>isServiceRunning是通过activityManage获取，完整的包名和类名<br>packageManage是静态的</p>
<p>设计模式<br>创建型：工厂（单个对象），抽象工厂（系列对象），单例，建造者，原型模式<br>行为型：策略，模板，观察者，迭代器，备忘录<br>结构型：代理，装饰，适配器，外观</p>
<p>单一职责（管理类），里氏代换，依赖倒置（面向接口）<br>接口隔离（订单系统：用户，开发商，管理者都需要，不能写在一起，而是分3个接口）<br>迪米特（中介模式）<br>开闭原则</p>
<p>克隆直接在内存中拷贝对象，不执行构造函数了<br>单例避免资源多重占用<br>工厂使对象的创建推迟到子类</p>
<p>模板方法就是我常用的抽象出父类来，子类只实现各自不同的方法<br>责任链模式类似击鼓传花这种，传入的对象是该类的实例，抽象处理方法</p>
<p>策略模式：高层里面持有策略的引用，构造函数传入具体策略类<br>迭代器模式：就是遍历集合<br>备忘录模式：备份和存储，就像游戏的存档<br>享元模式：池技术，有个map</p>
<p><a href="http://douxing.com/badou/floatin?sys=android&amp;ver=2.3.6" target="_blank" rel="noopener">http://douxing.com/badou/floatin?sys=android&amp;ver=2.3.6</a><br>cardUseCompatPadding=true</p>
<p>在新的那份 XML 的 CardView 中加入属性 android:stateListAnimator=”@anim/touch_raise”。这样，你的卡片按住时就会有浮起（阴影加深）的效果了。<br>至于波纹效果只需要给CardView加上android:foreground=”?attr/selectableItemBackground” 属性即可。</p>
<p>moveTaskToBack：作用是不再Finish到此Activity，仅仅是把它放到后台隐藏。类似于用户主动触发系统Home键的效果。在同是点击返回键优化前后的对比如下：</p>
<p>事件分发用了责任链模式</p>
<p>工厂模式需要子工厂实现，便与测试<br>克隆对象优化资源占用，比如发邮件</p>
<p>代理模式：数据来源代理，控制对象的访问权限<br>组合模式：实现树状结构，菜单，文件夹，平等的结构</p>
<p>面试指南</p>
<p>arraylist不是线程安全的，vector是线程安全的<br>arraylist性能高，vector源码里有许多syncchronized修饰符，效率低<br>arraylist扩容是增加50%，vector是一倍</p>
<p>旧的Activity的onpause执行太多就会导致新Activity的启动太慢<br>activity没被杀死就会从onstop开始到onrestart<br>view的onSaveInstanceState实现保存数据<br>textview的文本是被保存了，但是edittext用户输入的是没有，因为不是settext</p>
<p>android:configChanges=”screenSize|orientation”<br>配置这句就是屏幕旋转时不重新创建Activity，但还是旋转的</p>
<p>android调js需要load(“javascript:funcs()”)<br>js调android需要windows.name.funcs();<br>创建一个空类起个名字就行了<br>json的optInt和optString不会报错</p>
<p>加密：base64把图片的二进制转为string<br>aes，des，rsa<br>md5：长度固定，抗修改<br>密码的md5值进行比对</p>
<p>以json提交需要添加header，并把jsonobject编程string</p>
<p>vollery适合多并发，activity退出会自动取消，不适合数据量大的</p>
<p>listview优化：<br>图片使用弱引用<br>bitmap压缩<br>回收中间变量，bitmap.recycle();  bitmap=null;</p>
<p>static修饰的变量生命周期很长</p>
<p>merge配合include使用<br>或根节点是framelayout且不需要设置background和padding</p>
<p>hv查看层级和结构，红色就多了，看measure，layout，draw的时间</p>
<p>为了防止内存溢出，使用占内存大或生命周期长的对象使用软引用或弱引用</p>
<p>图片大小，像素总数都要小<br>以屏幕宽高来缩放图片，比如以宽为主<br>回收bitmap：bitmap.recycle();  bitmap=null;<br>mat检测内存</p>
<p>避免内存泄漏：<br>单例模式使用application的context，这样activity退出时就会回收了<br>不在非静态内部类创建静态实例<br>及时关闭资源file，cusor，并设置为null</p>
<p>耗时操作显示进度，或者加载一个splash<br>同一签名的程序可以运行在同一个进程<br>混淆也可以减小体积</p>
<p>apk瘦身：<br>开启精简代码和混淆<br>开启精简资源<br>只保留中文 resConfig “zh”<br>png压缩<br>大图使用jpg<br>使用webp<br>删除无用so，保留armeabi<br>使用shape代替图片，使用9patch<br>使用tint完成着色</p>
<p>gradle<br>gradle wrapper兼容性<br>包含一个gradlew的命令</p>
<p>从eclipse转移到as时自动生成gradle文件<br>手动迁移只需要书写目录路径</p>
<p>manifest里的包名只用在R文件调用中，而applicationID则作为app的表示，分开了<br>如果变了需要重新申请key吗，应该不需要</p>
<p>侧边栏的gradle命令<br>buildConfig全局变量配置，代码读取，比如构建号<br>在gradle里面可以配置变量，并通过代码得到<br>比如测试一个api和log开关，发布一个<br>buildConfigField “String”, “API_URL”, “\”<a href="http://test.api\" target="_blank" rel="noopener">http://test.api\</a>“”</p>
<p>debug和realase名字不一样</p>
<p>allprojects可以统一定义所有app模块<br>比如定义一个全局的版本<br>ext {    supportLibsVersion = ‘25.2.0’    recycleviewSupportLibsVersion = ‘25.2.0’}<br>${rootProject.supportLibsVersion}<br>或者rootProject.ext.buildToolsVersion</p>
<p>依赖自己的maven添加url和登录信息<br>没有发布在maven和jcenter的需要添加域名</p>
<p>testCompile<br>debugCompile<br>不会加到发布的项目里</p>
<p>2.3.1<br>第1个是api不兼容变化，大版本<br>第2个是向后兼容<br>第3个是修复bug</p>
<p>compile ‘com.android.support:design:25.2.+’  25.2.5<br>compile ‘com.android.support:design:25.2+’   25.3<br>compile ‘com.android.support:design:+’          最新版本</p>
<p>安卓依赖在线库可以直接搜索的</p>
<p>自定义buildType<br>staging.initWith(buildTypes.debug)staging {    debuggable = false;    applicationIdSuffix “.staging”    versionNameSuffix “-staging”}</p>
<p>minifyEnabled是清除无用的文件资源</p>
<p>buildType不光是realease和debug，还有自定义<br>applicationId不同，就可以一起装<br>applicationIdSuffix包名添加一个后缀<br>src下面不能main和分目录都有，共有的还不一样的单个src都要复制<br>资源文件除了values和mainfest是合并外，其他都会覆盖</p>
<p>debugCompile说明只在debug才引用该库<br>productFlavor和buildType一样，定义<br>多个维度，比如客户和是否免费的2个维度，src也一样了</p>
<p>避免每次都构建那么多模块，一个是aar方法</p>
<p>资源和mainfest的优先级：<br>buildType &gt; productFlavor &gt; main &gt; library</p>
<p>gradle许可文件重复<br>packagingOptions {    exclude ‘META-INF/LICENSE.txt’    exclude ‘META-INF/NOTICE.txt’    exclude ‘META-INF/rxjava.properties’}</p>
<p>自动重命名apk<br>applicationVariants.all { variant -&gt;    variant.outputs.each { output -&gt;        def outputFile = output.outputFile        if (outputFile != null &amp;&amp; outputFile.name.endsWith(‘.apk’)) {            // 输出apk名称为Release_V1.0_wandoujia.apk            def fileName = “${variant.productFlavors[0].name}<em>v</em>${variant.versionName}_release.apk”            output.outputFile = new File(outputFile.parent, fileName)        }    }}</p>
<p>自定义插件并上传到maven</p>
<p>引用模块路径，根目录，使用冒号表示文件夹<br>compile project(‘:extra:pdf’)</p>
<p>安卓有很多单元测试工具<br>定义一个任务在执行阶段才执行而不是初始化和配置时<br>自动化持续集成 jenkins</p>
<p>加速构建：设置，build里<br>org.gradle.parallel=true 线程<br>org.gradle.daemon=true 开启守护进程<br>jvm虚拟机参数<br>org.gradle.configureondemand<br>多个模块的时候没改变就不构建了<br>忽略lint<br>lintOptions {    checkReleaseBuilds false    abortOnError false}</p>
<p>—profile来生成构建报告</p>
<p>混淆需要先开启minifyEnabled，精简资源也是<br>保留一个类使用keep<br>shrinkResources   执行任务可以看缩减了多少<br>反射和动态的会出问题<br>也可以指定哪个res文件不精简</p>
<p>可以使用resConfig缩减指定的dpi和语言</p>
<p>插件开发<br>因此我们定义的Action在继承AnAction时，需要重写actionPerformed函数。定义好Action类后，我们需要注册Action</p>
<p>AS技巧<br>按列选择按下alt<br>补全大括号 ctrl shift enter  可以用代码模板来替换<br>tab和enter代码补全的不同<br>ctrl alt h 哪个类中调用了这个方法<br>ctrl shift i快速预览类和方法的实现<br>ctrl shift a 快速使用命令</p>
<p>条件断点很好用<br>调试中途log输出 不用重新编译代码，是打印在debug界面的<br>debug时手动设置变量的值，右键setValue<br>还可以观察变量<br>计算表达式的值</p>
<p>analyze中有how to flow/to here</p>
<p>alt按列选择<br>方法调用路径 ctrl alt h<br>快速预览方法实现 ctrl shift i<br>快速使用命令 ctrl shift a<br>代码不全 enter和tab有差别，tab删掉后面<br>if和循环自动加上大括号 ctrl shift enter </p>
<p>简历</p>
<p>aidl，ndk，插件化，热修复<br>listview优化</p>
<p>面试起作用的书：</p>
<p>第一行代码<br>gradle<br>面试指南<br>开发艺术探索<br>群英传<br>MaterialDesign<br>性能优化</p>
<p>建立一条开发流水线，提升开发效率； 同时配合良好的结构设计，和通用模板类的编写</p>
<p>做过离线地图 烟草 律师<br>代码变量可以中文命名</p>
<p>3.为什么equals()相等，hashCode就一定要相等，而hashCode相等，却不要求equals相等?<br>（1）因为是按照hashcode来访问小内存块，所以hashcode必须相等；<br>（2）HashMap获取一个对象是比较key的hashcode相等和eaqual为true；<br>        之所以hashcode相等而equal不相等，就如同objectA和objectB都有属性name，而hashcode都以name计算，所以hashcode一样，但两个对象属于不同的类型，所以equal为false。</p>
<p>4.为什么需要hashcode？<br>（1）通过hashcode能很快找到小内存块；<br>（2）通过hashcode比较比equal快，当get时先比较hashcode，如果hashcode不同直接返回false。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/28/技术整理/待整理-手机卫士-设计模式-面试指南-graddle-as技巧/" data-id="cjajd03qj000vdwlljujc6ft4" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-技术整理/性能优化书" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/28/技术整理/性能优化书/" class="article-date">
  <time datetime="2017-11-28T08:26:16.000Z" itemprop="datePublished">2017-11-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>安卓优化：<br>快：响应速度<br>稳：不要崩溃和ANR无响应<br>省电省流量，避免发烫<br>小：安装包</p>
<p>内存增加导致gc频繁，引起卡顿<br>层次少，view少，减少测量布局绘制的时间，深度优先，递归调用<br>16ms内draw</p>
<p>traceview来分析cpu占用<br>systrace begin和end匹配，同一线程</p>
<p>jpg压缩不要渐进式，不要元数据exif和xmp，不内置缩略图<br>压缩图片，缩小bitmap，使用缓存</p>
<p>listview重用了view，不被垃圾回收，进而流畅<br>viewholder只查找一次，然后保持引用</p>
<p>ondraw和onlayout不要分配内存，多次调用</p>
<p>条形图和过度绘制图<br>透明的设计会慢一些<br>红色区域就需要修复，绿色也不太好<br>过度绘制，theme的背景，layout的，item的</p>
<p>Hierarchy Viewer查看绘制时间，不显示原因，层级结构<br>导出为psd</p>
<p>drawable的实际绘制尺寸由rect的setbounds来决定<br>Inspect-code 分析代码lint</p>
<p>布局优化：布局复用<br>减少层级：<br>层级相同时使用LinearLayout，有weight需要2次测量；<br>可以减少层级则用RelativeLayout，2次测量，慢；<br>合理使用merge：<br>自定义view父元素是framelayout和LinearLayout时使用<br>比如自定义的actionbar，代码设置背景属性；<br>merge需要parent并且attchToRoot设置为true；<br>viewstub和merge不混用<br>Activity的跟布局是framelayout时使用，把它先取出来；<br>自定义view减少层级；</p>
<p>提高显示速度：<br>viewstub：布局N选1，不适用于按需隐藏；(一个xml里多个viewstub占位)<br>属性越少解析越快，删除无用属性<br>减少view数<br>wrap_content尽量用具体值代替</p>
<p>过度绘制<br>蓝色多绘制一次，整个蓝可以优化；<br>红色4次</p>
<p>xml中不可见的或者重叠的区域绘制<br>Activity的默认背景去除：<br>getWindow.setBackgroundDrawable(null);</p>
<p>onDraw区域外的不进行绘制，canvas.clipRect();<br>application生命周期长，全局单例，可以用来替代静态变量<br>少用activity的context，会导致内存泄漏</p>
<p>attachBaseContext来存储context，提供一个全局的get方法</p>
<p>启动优化<br>自己写一个打点的计时工具类<br>必要耗时：开启线程<br>分布加载，异步加载，延期加载</p>
<p>刷新优化：<br>减少次数，局部刷新，控制刷新频率<br>数据没有变化时不用刷新，比如搜索</p>
<p>后台线程不要占大量的cpu<br>比如listview滑动时让线程暂停工作，停下来后再继续执行</p>
<p>局部刷新：<br>invalatedata(Rect)和4个位置值，只刷新局部<br>还有列表的item变了只刷新单个，单条刷新</p>
<p>traceview看displayList，calls+Recur calls 调用/递归调用<br>属性动画效率高，同时开启硬件加速</p>
<p>不是所有2d操作都支持，开启全局会出现自定义view问题<br>开启硬件加速的级别：<br>application，Activity，window，view4个层面，可以覆盖<br>window.setFlag();<br>view.setLayertype(View.LAYER_TYPE_SOFTWARE,null);<br>硬件加速原理是一个view变了不用遍历viewtree，每个view都有一个displayList，当viewtree全部记录完毕后绘制</p>
<p>给view设置硬件加速，动画执行完后设置为typenull<br>硬件加速不能和bitmap复用一起用，和过度绘制一起出现有问题</p>
<p>RandomAccessFile：随机访问文件流，可以定位到某处<br>seek(length);<br>发现问题，分析问题，找到原因</p>
<p>java对象生命周期：不用的设置为null<br>ActivityManage.getMemoryClass()获取内存阈值</p>
<p>内存空间不够就会gc<br>不要手动调用gc<br>gc阻碍ui线程，16ms，频繁gc会卡顿</p>
<p>内存泄漏就是gc没有识别出不再使用的对象，导致内存越来越少，oom了</p>
<p>内存优化：减少oom，减少ui卡顿，提高存活率<br>as自带的内存检测：突然增加看是bitmap还是别的<br>如果抖动太厉害就是频繁gc，也会卡顿<br>内存周期没走完</p>
<p>heap viewer<br>mat功能好，gc root可达就不会释放</p>
<p>1.资源未关闭：file，cursor都是有缓存的，先close，在设为null，finally中执行；<br>2.注册对象未注销：广播和观察者<br>3.静态变量长期维持引用<br>4.非静态内部类的静态实例，可以使用静态内部类，或者AppContext或用完context设置为null<br>5.message太久导致handler无法被回收，act无法回收<br>创建一个静态的handler内部类，并持有弱引用<br>static MyHandler   WeakReference<context> context;<br>destroy的时候handle移除对象和消息 handler.removeMessageAndCallbacks<br>asyncTask也需要处理，都是handler<br>6.webview，开启独立进程，使用aidl和主进程通信，自行销毁</context></p>
<p>使用leakcanary库来分析，release依赖，检测fragment，自定义处理结果，拿到hprof文件，自己用mat分析</p>
<p>debugCompile leakcanary 分析</p>
<p>垃圾回收线程优先级低，一个对象可以有多种引用<br>软引用配合引用队列来用</p>
<p>自动拆箱会降低性能<br>比如hashmap中使用Integer，可以使用Android优化的SparryArray，ArrayMap来代替hashmap</p>
<p>利用系统自带的资源，图片，颜色和布局<br>view的复用，对象池，对象复用，bitmap复用</p>
<p>arraymap代替hashmap的场景：连续内存，不是链表<br>1000个数目一下，访问多，很少插入和删除</p>
<p>枚举保证了类型安全，性能太差<br>安卓使用注解来检查类型安全@IntDef</p>
<p>lru的一个值被访问时放到队尾，对头的先出去<br>sizeof返回每个缓存对象的大小</p>
<p>bitmap占内存=width<em>height</em>单像素占字节数<br>位图格式：ARGB8888  32位  rgb565  16位  argb4444 16位<br>大图一般用argb8888，列表和小图使用rgb565<br>用户头像可以用argb4444</p>
<p>安卓只支持位图<br>inPreferredConfig设置位图规格<br>inSampleSize设置压缩率，指数缩放<br>更精细的需要inScaled，inDensity，inTargetDensity，和采样率结合使用<br>inBitmap重用内存，不释放和分配了，相同解码格式，不用recycler了</p>
<p>复用先有一个set弱引用，然后在lru的enterMoved里面加到集合里面<br><a href="http://www.cnblogs.com/mengfanrong/p/4679342.html" target="_blank" rel="noopener">http://www.cnblogs.com/mengfanrong/p/4679342.html</a><br>不同api下判断，4.4以下必须相同，以上就是大小够了就可以，就是从集合里迭代每个item的大小超过要求的，就拿出来用</p>
<p>单例模式的双重锁线程安全<br>volatile关键字，区域对象锁而不是方法锁</p>
<p>private volatile static Singleton instance;<br>public static Singleton getSingleton() {<br>        if (instance == null) {<br>            synchronized (Singleton.class) {<br>                    instance = new Singleton();<br>           }<br>        }<br>        return instance;<br>    }</p>
<p>closeUtil实现关闭资源，不用那么多try-catch<br>scroll监听器里，fling时pause</p>
<p>缓存目标：<br>同一图片加载一次，节省流量，内存池控制整体图片大小</p>
<p>从这里看出，当给Integer直接赋值时，如果在-128到127之间相等的话，它们会共用一块内存，而超过这个范围，则对应的Integer对象有多少个就开辟多少个</p>
<p>integer直接赋值相等，new出来不相等，128不等</p>
<p>代理模式扩展方法<br>观察者模式</p>
<p>有比json更小的序列化对象<br>不要跨进程操作sp</p>
<p>数据库使用单例模式封装，避免多线程问题，context使用ApplicationContext，避免内存泄漏<br>数据库循环插入多条数据使用事务，效率极高<br>beginTransaction  setTransactionOnSuccessful<br>endTransaction写到finally里<br>大表使用索引，适合读不适合写</p>
<p>数据库放到异步线程，app中初始化，加同步锁<br>双缓存，建立一个数据库的内存缓存，异步更新</p>
<p>列名多查询快</p>
<p>崩溃和anr<br>全局的捕捉异常，下次有网时再上传</p>
<p>网络和图片模块需要好好设计接口<br>代码复用，不要复制<br>安卓对方法数有限制，函数参数多可以考虑用一个model</p>
<p>checkstyle更注重风格<br>findbugs侧重代码缺陷</p>
<p>全局捕获异常上传并人性化提示，先保存本地，下次上传<br>native层的crash<br>anr有3种<br>adb pull /data/anr/traces.txt 不区分root<br>在studio里面分析哪个线程堵塞</p>
<p>anr的log，看cpu使用率，iowait，reason<br>analyze stacktrace 把traces.txt的内容复制进来就可以看到，标红的线程就是堵塞了<br>anr检测，就是给looper设置一个printer，检测dispatch前后的时间</p>
<p>提高进程存活率<br>ddm_adj打的优先级低，占内存大的优先杀死<br>通过长连接，alarmmanage+service，bootreceiver挂起进程<br>通过账号同步机制syncadapter来提升优先级由4变为1</p>
<p>省电：<br>gps，后台同步<br>在oled上使用深色更省电，lcd只是亮度</p>
<p>网络请求导致20s的切换，把所有请求放到同一时刻，减少频率<br>json和protobuf效率比xml高<br>使用gzip压缩</p>
<p>避开浮点运算：<br>除法变乘法<br>利用移位</p>
<p>通过pm获取wake，模式有cpu运行，键盘屏幕关闭</p>
<p>jobscheduler<br>不紧急的任务交给他去做，可延迟的，充电时</p>
<p>doze的5种状态机<br>断网，闹钟，开屏，同步，job</p>
<p>但会受到doze的影响alarm job 网络 wake<br>使用alarm的setExactAndAllowWhileIdle<br>引导用户加入白名单，可以访问网络和wakelocks</p>
<p>//判断是否加入白名单<br>isIgnoringBatteryOptimizations()<br>//请求加入白名单<br>Intent intent=new Intent(ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS);</p>
<p>lint命令提出无用资源<br>一套布局多套dimension来适配屏幕<br>限定符来过滤语言<br>轻量级的第三方库<br>预置图片服务器下发，或者插件化，使用不高的模块<br>webp<br>功能重复的第三方库<br>插件化</p>
<p>冷热启动，界面跳转，绘制刷新，事件响应</p>
<p>把和ui无关的工作都放到子线程中<br>先通过GPU Profile观察柱状图高低，然后使用HV查看渲染时间优化</p>
<p>TraceView  代码使用<br>Debug.startMethodTracing();<br>x轴是时间，y轴是进程，面积大，占cpu长<br>call+recall表示方法调用和递归次数</p>
<p>hv红色表明是该阶段最慢的<br>通过lint  inspect code分析整个项目</p>
<p>自定义view的根布局可以用merge来代替，属性使用代码设置<br>merge是要求attachToRoot为true并且有parent的</p>
<p>canvas有减少过度绘制的方法，指定区域，判断相交<br>clipRect可以避免自定义view的重叠区域重复绘制</p>
<p>定义一个全局获取ApplicationContext的静态单例方法<br>attachBaseContext<br>少用Activity的context</p>
<p>点击icon没反应之后可以theme放一个logo或透明色<br>启动优化，局部刷新<br>启用线程初始化，如极光，百度地图等第三方的<br>Activity退出后取消网络请求<br>invalidate(Rect)刷新一个区域，listview的notifyItem<br>列表不要整体刷新，而是单条刷新</p>
<p>硬件加速，displaylist原理</p>
<p>anr检测：写一个Printer实现Looper的Printer，记录dispatchMessage前后的时间差即可<br>Looper.getMainLooper().setMessageLogging(this/null);<br>printer.onStartLoop<br>printer.onEndLoop</p>
<p>java对象生命周期<br>各种强弱引用<br>内存分配空间  image space</p>
<p>内存回收机制，年轻区，老区，复制清空，年轻区GC短<br>年轻区是复制存活的对象</p>
<p>gc日志：<br>GC_CONCURRENT<br>GC_FOR_MALLOC分配内存时停下来gc<br>GC_EXPLICIT 手动调用system.gc触发的<br>freed表明回收了多少内存<br>60% free 1234k/3334k 表示还有60%内存可用</p>
<p>ART的GC缩短了pause时间，有并发和非并发，大内存分配<br>内存优化提高存活率</p>
<p>heapView只是粗略观看，类似mm<br>heapVIew导出hprof文件，as做一个转换，mat读取</p>
<p>mat<br>top consumers 图形化展示变量大小<br>leak suspects 分析报告</p>
<p>看Retained Heap是包含引用的<br>选中一个view，点击merge-exclude weak/soft/etc<br>显示距gc最短的路径，也就是不可被回收的<br>一般对比2个hprof文件找泄漏，对象个数增加就是泄漏</p>
<p>找到最大的对象，分析它的引用链</p>
<p>关闭资源，回收缓存<br>观察者对象要解注册</p>
<p> 代码优化使用Android特有的一些结构，序列化，map的替代java原生的<br>枚举使用注解来约束类型安全</p>
<p>//使用注解代替枚举<br>@IntDef({LE1,LE2})<br>@Retention(RetentionPolicy.SOURCE)<br>public @interface PER_LEVEL{}</p>
<p>public static final int LE1=1;<br>public static final int LE2=2;<br>public void setIn(@PER_LEVEL int i){}</p>
<p>位图规格，采样率，复用</p>
<p>写一个closeable的静态方法来关闭资源</p>
<p>public static void close(Closeable closeable) {<br>    if (closeable != null) {<br>        try {<br>            closeable.close();<br>        } catch (IOException e) {<br>            e.printStackTrace();<br>        }<br>    }<br>}</p>
<p>//不同版本计算bitmap大小<br>public static int getBitmapSize(Bitmap bitmap) {<br>    if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {    //API 19<br>        return bitmap.getAllocationByteCount();<br>    }<br>    if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB_MR1) {//API 12<br>        return bitmap.getByteCount();<br>    }<br>    // 在低版本中用一行的字节x高度<br>    return bitmap.getRowBytes() * bitmap.getHeight();                //earlier version<br>}</p>
<p>bitmap访问频率可以进行分级，使用多个lru管理<br>disklru要对url做key md5</p>
<p>fresco优在内存管理，渐进展示，更多格式，加载策略丰富</p>
<p>serializable适合文件和网络传输，parcel适合内存，用于IPC<br>serializable引起频繁gc</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/28/技术整理/性能优化书/" data-id="cjajd03qk000wdwllzlvduomf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-技术整理/安卓学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/28/技术整理/安卓学习/" class="article-date">
  <time datetime="2017-11-28T08:26:16.000Z" itemprop="datePublished">2017-11-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>use-feature来限制设备硬件<br>support_screen来限制设备屏幕</p>
<p>用滑块来代替输入<br>发布关闭debug,manifest设置debuggable<br>代码通过if-else来判断</p>
<p>handle对ui 多线程加锁，不错乱<br>不用考虑多线程的错乱问题了<br>handlerThread避免多线程导致的空指针<br>handler的loop是在子线程中，调用thread.getLooper和一个handlerthread绑定，就是子线程了<br>主线程子线程互相通信<br>handler.post更新ui runonuithread  view.post 3种便捷方法<br>activity和view用自己的handler更新ui</p>
<p>zoom:覆盖类,写样式,旧的文件要从jar包里删除<br>复制一模一样,然后自己修改,删掉旧的,不用降级</p>
<p> Handler handler2 = new Handler(new Handler.Callback() {<br>        //拦截消息，true，拦截了后面的handleMessage不执行<br>        @Override<br>        public boolean handleMessage(Message msg) {<br>            return false;<br>        }<br>    }) {<br>        @Override<br>        public void handleMessage(Message msg) {<br>            super.handleMessage(msg);<br>        }<br>    };</p>
<p>onresume创建viewrootimpl，所以oncreate里面子线程可以修改ui，但休眠之后就不行了<br>线程里面不能new handler，用hanlder必须制定looper对象</p>
<p>webview设置title  onReceivedTitle<br>//下载东西<br>webView.setDownloadListener(new DownloadListener() {<br>            @Override<br>            public void onDownloadStart(String url, String userAgent, String contentDisposition, String mimetype, long contentLength) {<br>                //URLConnection下载方式<br>                //使用下载管理器<br>                Uri uri = Uri.parse(url);<br>                Intent intent = new Intent(Intent.ACTION_VIEW, uri);<br>                startActivity(intent);<br>            }<br>        });</p>
<p>错误码解决<br>public void onReceivedError(WebView view, WebResourceRequest request, WebResourceError error) {<br>                super.onReceivedError(view, request, error);<br>                view.loadUrl(“本地文件 assert”);<br>            }</p>
<p>viewstub适合网络请求完后显示<br>混淆后webview和js互调有问题，keep实体类</p>
<p>多渠道打包集成友盟，manifest里面写个变量<br>productFlavors.all{<br>  flavor -&gt; flavor.manifestPlaceholders = [UMENG_CHANNEL_VALUE:name]<br>}<br>文件命名，签名<br>resValue ‘string’, ‘app_name’, “中智i学”<br>这种要先把values下的app_name先删掉</p>
<p>测试不同功能点 okhttp和jpush applicationIdSuffix，就不需要卸载可以并存了，包名是不变的</p>
<p>文件命名：<br>applicationVariants.all { variant -&gt;<br>                variant.outputs.each { output -&gt;<br>                    def outputFile = output.outputFile<br>                    if (outputFile != null &amp;&amp; outputFile.name.endsWith(‘.apk’)) {<br>                        // 输出apk名称为Release_V1.0_wandoujia.apk<br>                        def fileName = “${variant.productFlavors[0].name}<em>v</em>${variant.versionName}_release.apk”<br>                        output.outputFile = new File(outputFile.parent, fileName)<br>                    }<br>                }<br>            }</p>
<p>引用libs下面的jar和aar<br>    compile fileTree(include: [‘<em>.jar’], dir: ‘libs’)<br>       fileTree(dir: ‘libs’, include: ‘**/</em>.aar’)<br>             .each { File file -&gt;<br>          dependencies.add(“compile”, [<br>                   name: file.name.lastIndexOf(‘.’).with { it != -1 ? file.name[0..&lt;it] : file.name },<br>                  ext : ‘aar’<br>          ])<br>       }</p>
<p>AppCompatActivity替代所有的<br>onResume里播放音频视频动画<br>onPause释放资源<br>onCreate的Bundle就是保存临时数据的<br>上传下载使用服务<br>xml里面配置boolean值，就像zxing在xml中配置integer一样<br>state_focused是否可以获取焦点<br>res下的东西都可以通过getResources来获得<br>资源的相互引用@<br>TextView使用ems来控制宽度，line控制高度，max和min<br>android:ems=”12”android:lines=”2”<br>setSelection和SelectAll  edittext的高亮<br>et1.selectAll();et1.setSelection(3,7);</p>
<p>字符串的样式CharSequence<br>xml中的大段文字使用引号和实体字符<br>格式化的字符串<br>显示html字符串<br>RadioGroup的clearCheck</p>
<p>gridlayout就没必要使用兼容库了，2.1版本<br>指定第几行第几列，横跨几行几列即可<br>得指定子控件的大小才行</p>
<p>Space创建一个空间<br>onActivityCreated方法里执行webfragment，保证只初始化一次</p>
<p>开启导航：<br>manifest配置parentActicityName<br>设置getSupportActionBar().setDisplayHomeAsUpEnabled(true);</p>
<p>颜色值：<br>colorPrimary是toolbar的颜色<br>colorAccent是控件的强调色<br>colorControlHighlight是高亮<br>textColorHint是提示文字颜色<br>colorPrimaryDark是状态栏的颜色<br>想全局使用都得使用一个theme才行</p>
<p><item name="android:textColorHint">#7b2828</item><br>果然有用<br>也可以配置字体</p>
<p>分割的actionbar使用toolbar在底部</p>
<p>模拟器太耗电了<br>使用fragment保持灵活<br>使用支持库保证兼容<br>提供灵活的布局</p>
<p>翻译string的只需要是个子集就行了，默认的写到string里<br>资源限定符共享资源：国家，横竖屏，屏幕宽高，夜间模式，分辨率，系统版本</p>
<p>context的操作文件的方法：<br>data/data/package_name/files/下面<br>openFileInput<br>openFileOutput</p>
<p>使用provider很简单，定义要什么，使用cursorLoader就行了，加权限<br>查阅通话记录，联系人<br>使用intent添加一个日历</p>
<p>moveright 并排查看<br>split vertically同一个文件打开两个窗口<br>自定义todo标签，指定一个单词作为标识也可以<br>productFlavors:配置不同的版本类型<br>src下面建不同的文件夹，就像中智和沁园的宝一样同步一套代码</p>
<p>使用contextCompat代替context实现兼容</p>
<p>刘的技能：</p>
<p>输入命令行，提交git<br>adb安装卸载app<br>分公司渠道构建项目<br>打包aar避免每次构建<br>抓包调试网络<br>窗口view调试器<br>写gradle脚本</p>
<p>阅读安卓英文文档<br>百分比库<br>databinding</p>
<p>checkedTextview<br>keyboardView<br>space</p>
<p>targetSdkVersion 如果设置6.0则开启权限询问，没有则是5.0之前的方式，新特性就不会用了</p>
<p>支付宝快捷服务，没有注册activity，就没有启动图标</p>
<p>在manifest配置activity时可以配置action1个和category多个，只有同时满足才会掉起<br>action相当于浏览器，电话，地图等<br>intent的data，scheme设置为http就可以注册浏览器了，host则是主机名，mimetype<br><data android:scheme="http"></data></p>
<p>activity返回数据不光返回键，还有onBackPressed也要写上，左上角点击返回</p>
<p>可见生存周期onstart和onstop，dialog的形式就不执行这两个，因为部分可见</p>
<p>onRestoreInstanceState是意外恢复，屏幕旋转情况下的，如果启动之后旧的activity被回收了，就需要oncreate，所以这里的bundle也需要用到，高级体验</p>
<p>singleTop只是避免自己重复创建自己，不在栈顶仍然不行<br>singleTask才是解决的，只要一个栈内就不重复生成，就需要重新setintent方法<br>onRestart方法重新调用<br>singleInstance共享活动实例，几个栈共享同一个实例<br>a-b-c，ac同栈，b是instance，返回cab，懂了吧</p>
<p>静态方法书写intent传参<br>button的英文是大写的<br>默认的progressbar是圆形的，加一句变进度style=”?android:attr/progressBarStyleHorizontal”</p>
<p>百分比布局：支持库support里<br>listview的优化<br>1.使用convertview，即不重复创建view而是复用view，一个if-else判断，为空时inflate，不为空则直接等于；<br>2.使用viewholder来避免频繁的findviewbyid<br>给view.settag(viewholder),控件的实例就缓存到了viewholder里</p>
<p>viewholder要继承recyclerView的viewholder，并传入一个view</p>
<p>列表的ui其实是虚的，都是根据position来的，那个只是展示的复用<br>linearlayout包裹textview的时候使用layout_gravity和wrap_content来控制重心，而不是用tv的match_parent<br>recyclerview的事件是由具体的view注册的<br>在viewholder里面存储一个itemview做为parent</p>
<p>发送消息的聊天界面采用实体类的type，布局一个左，一个右来实现隐藏，不是用的2个xml<br>当添加一条消息时先清空edittext，然后就像添加一个卡片一样，列表展示到最新的一条，最新的在最下面<br>gridAdapter.notifyItemInserted(list.size()-1);recyclerView.scrollToPosition(list.size()-1);<br>fragment之间的通信通过activity<br>fragment不调用addToBackStack就会销毁执行onDestroy，加入栈之后就只执行到onDestroyView</p>
<p>静态fragment标签指定id<br>从holder里获取position<br>holder.getAdapterPosition()<br>动态注册广播，静态注册实现重启监听<br>manifest配置广播，enabled是否启用exported是否允许接受其他程序的广播<br>广播只是启动其他服务的，不要开线程</p>
<p>自定义广播需要添加过滤器，action是自己定义的<br>那些都是全局广播，本地广播是只有自己程序收的到，安全，高效<br>就是把注册解绑发送，都用LocalBroadcastManager来执行即可,只能动态注册</p>
<p>广播实现强制下线功能：<br>在baseActivity里的onResume和onPause里注册解绑广播，广播里弹dialog阻塞</p>
<p>git初始化和验证git config –global <a href="http://user.name/" target="_blank" rel="noopener">user.name</a> “feifei”<br>定位到项目目录<br>先cd<br>/Users/feifei/Downloads/MyApplication git init<br>git add .<br>git commit -m “first test git”</p>
<p>文件存储：<br>目录在data/data/package/files/下面<br>写文件 openFileOutput，传入文件名和MODE_APPEND或MODE_PRIVATE<br>返回fileoutputstream对象<br>读文件 openFileInput</p>
<p>存储密码是对密码做md5加密后存储，sp，验证时也是md5之后验证是否匹配</p>
<p>data/data/package/ files databases shared_prefs  caches</p>
<p>命令访问数据库#是超管root  $是普通，需要su切换 cd data/data/package/databases   ls</p>
<p>sqlite就可以执行sql命令了</p>
<p>扩展数据库，添加表，需要升级版本号，删旧表，建新表</p>
<p>危险权限：相机，位置，联系人，麦克风，手机，短信，存储<br>运行时请求<br>权限组申请一个就够了，不用都申请，这也是变化</p>
<p>使用provider，是通过contentresolver来操作crud的，uri就是包名+表名<br>content://com.example.app.provider/table1</p>
<p>git status 显示哪些文件变化了<br>git diff +和-<br>撤销未提交的修改，工作上<br>checkout reset针对add之后的<br>git log xxx -1 -p 查看详细提交</p>
<p>6.0读写sd卡需要权限，还有定位<br>getExternalCacheDir<br>sdcard/android/data/package/cache/下面，这个在6.0以上不需要权限</p>
<p>从图库中选择图片要先判断write——external权限，然后使用intent，返回结果4.4以下和以上要分别处理</p>
<p>选择相片和使用mediaplayer都需要判断write_external_storage权限，6.0以上，要写sd卡嘛<br>videoview就是对mediaplayer的一个封装而已，格式支持不全</p>
<p>网络是要在线程中发起的，返回结果要runonuithread<br>sax解析法挺简单的<br>pull方法代码少<br>urlconnection和okhttp</p>
<p>服务运行在主进程和主线程里，需要手动开启一个新的线程<br>handler,message,messagequeue,looper<br>looper是个循环，从messagequeue读消息，发给handler<br>asynctask参数，中间进度，返回值</p>
<p>多点几次启动服务只会执行onStartCommand<br>在应用列表中能看到自己的服务<br>每个服务只存在一个实例<br>服务启动既调用start又调用bind则需要执行2个方法才能解绑<br>前台服务显示在系统状态栏像天气的<br>在服务里开线程就会一直运动下去，知道手动停止，intentService则会自动停止，避免忘记开线程，忘记调用stopSelf()<br>start保证一直运行<br>bind是保持通信，2个一起用</p>
<p>定位的3种模式<br>百度定位不需要application初始化<br>跟踪我的运动 MyLocationData<br>    MyLocationData data = new MyLocationData.Builder()<br>                            .latitude(result.getLatitude())<br>                            .longitude(result.getLongitude()).build();<br>                    baiduMap.setMyLocationData(data);<br>一直在master上开发，小版本拉一个分支，改完bug合上来，而不是开发前拉分支，是发布后拉分支<br> git branch<br>在分支上merge需要先切回主干再merge<br>git checkout master<br>git merge test</p>
<p>fetch merge=pull<br>使用toolbar<br>design库app命名是向下兼容的</p>
<p>DrawerLayout搭配navigationview使用，包括一个menu和headlayout<br>snackbar是可以和用户交互的，撤销<br>ConstraintLayout可以替代framelayout<br>ConstraintLayout的子view才可以协调，snackbar传入的第一个view<br>简单加载网络图片使用glide方便</p>
<p>在ConstraintLayout有toolbar和recyclerview，需要用appbarlayout包裹toolbar，并给recyclerview指定一个行为就可以避免遮挡，想要toolbar运动需要指定scrollflag<br>行为指定给父容器<br>下拉刷新控件</p>
<p>CollapsingToolbarLayout 要和appbarlayout和toolbar一起用，还有ConstraintLayout</p>
<p>把需要显示在状态栏里的控件和他的父容器加上android:fitsSystemWindows=”true”<br>同时还需要指明系统状态栏为透明色 21才支持，需要限定符创建2个theme</p>
<p>parcelable序列化读写顺序要一致<br>长按菜单键进入多窗口模式<br>该模式下视频播放就不能写在onpause里而是onstop里<br>禁止屏幕旋转，activity重建在manifest里加configChanges，在代码里加onConfigChanged方法自己处理<br>在24上写resizeableActivity=false<br>以下则不允许横竖屏旋转则可禁用多窗口，screenOrientation=portrait</p>
<p>git push<br>git push <a href="https://github.com/PeiZhiFei/Weather.git" target="_blank" rel="noopener">https://github.com/PeiZhiFei/Weather.git</a> test/master</p>
<p>android:layout_height=”?attr/actionBarSize”<br>android:background=”?attr/colorAccent”</p>
<p>@serializedname是让json和java字段建立映射<br>接送嵌套就创建内部类就行了</p>
<p>右侧task面板有很多执行的脚本命令<br>兜行那种写法用的一个签名文件同时打包出2个apk<br>先定一个signingConfig signingConfigs.config<br>密码安全信息写到gradle.properties里面</p>
<p>aar的打包<br>多渠道<br>productFlavors下面添加多个变量，然后在src里面和main并列建包，包名可以不一样applicationId<br>不能以数字开头<br>可以复写defaultConfig的任何属性</p>
<p>adb install xxx.apk   命令行安装<br>360是需要对加固后的文件重新签名</p>
<p>adb push传文件<br>模拟滑动和输入<br>adb shell input touchscreen swipe 18 165 18 330<br>adb shell input keyevent 4</p>
<p>ctrl+alt+o:去除无用包<br>app:contentInsetStart=”0dp”</p>
<p>   private CollapsingToolbarLayoutState state;</p>
<pre><code>private enum CollapsingToolbarLayoutState {
    EXPANDED,
    COLLAPSED,
    INTERNEDIATE
}
</code></pre><p>AppBarLayout app_bar = (AppBarLayout) findViewById(R.id.app_bar);<br>        app_bar.addOnOffsetChangedListener(new AppBarLayout.OnOffsetChangedListener() {<br>            @Override<br>            public void onOffsetChanged(AppBarLayout appBarLayout, int verticalOffset) {</p>
<pre><code>        if (verticalOffset == 0) {
            if (state != CollapsingToolbarLayoutState.EXPANDED) {
                state = CollapsingToolbarLayoutState.EXPANDED;//修改状态标记为展开
                collapsingToolbarLayout.setTitle(&quot;EXPANDED&quot;);//设置title为EXPANDED
            }
        } else if (Math.abs(verticalOffset) &gt;= appBarLayout.getTotalScrollRange()) {
            if (state != CollapsingToolbarLayoutState.COLLAPSED) {
                collapsingToolbarLayout.setTitle(&quot;&quot;);//设置title不显示
                test.setVisibility(View.VISIBLE);//隐藏播放按钮
                state = CollapsingToolbarLayoutState.COLLAPSED;//修改状态标记为折叠
            }
        } else {
            if (state != CollapsingToolbarLayoutState.INTERNEDIATE) {
                if (state == CollapsingToolbarLayoutState.COLLAPSED) {
                    test.setVisibility(View.GONE);//由折叠变为中间状态时隐藏播放按钮
                }
                collapsingToolbarLayout.setTitle(&quot;INTERNEDIATE&quot;);//设置title为INTERNEDIATE
                state = CollapsingToolbarLayoutState.INTERNEDIATE;//修改状态标记为中间
            }
        }
    }
});
</code></pre><p>aar打包<br>还有定制化的分包放类 和 flavor<br>父子类李氏代换  强转<br>多态性的实现<br>二分查找<br>设计模式思想 原则 装饰者模式<br>rxjava<br>mvp优缺点<br>内存中的方法<br>操作系统跨进程通讯 rpc 网<br>缓存设计<br>ui线程<br>todo面板</p>
<p>用MyBaseA不能使用自己的list，得用adapter的方法修改list<br>REFRESH重复的问题<br>点击事件的问题<br>修改bug拉分支 测试代码不提交 提交要慎重<br>List遍历数据不像map简单，可以省掉一层循环<br>map去重，快速判断有没有某个key对象<br>command和option按方向键快速跳转</p>
<p>命名用books而不是booklist，其实很简单，不是想太多<br>if的条件很长，提出一个方法来<br>ctrl+shift+e找用途,还有分析<br>提取方法,style<br>搜索类快捷键的是什么 class  ctrl+N<br>大数字用long，不用int  bigdecimeal<br>大整数的数据结构和算法实现</p>
<p>布局的多机型调试,语言,版本,主题,多语言很方便的<br>tools为list指定item和header footer<br>通过编辑器设计模式修改id是很好的</p>
<p>monkey ui盲测,压力测试,乱点,使用shell<br>adb shell monkey -p com.badou.mworking -v 500</p>
<p>git工作流,每一个版本一个分支,都往主干上合并,主干上打包,真的很好用<br>分析工具类 lint<br>analyze inspect code 检查所有的代码,和lint一样</p>
<p>alt F8调试时进入表达式计算器,可以计算如findViewById(R.id.parent).getVisibility()<br>run view breakpoint 断点浏览器 输入条件<br>右击断点添加条件,用于for循环当i等于某个值时进入</p>
<p>as定制界面，菜单（没有不能定制的），代码风格（华为），快捷键，宏，文件模版，插件<br>收藏面板，最近文件，查找类，文件，字符串<br>代码模板，重构提取<br>git分支<br>界面设计，微调<br>测试，调试，分析，终端，断点表达式<br>性能分析<br>单元测试<br>层次查看器查看ui问题</p>
<p>引用aar错误报manifest合并错误,是buildtool这些不一致,gradle最终会生成到manifest里面<br>在adapter里面下载图片,async用完后null,初始化时cancel<br>ddms里面线程监视器,堆监视器,网络统计监视,层次查看器</p>
<p>//如果你的jar包/依赖代码 在编译的时候需要依赖，在运行的时候也需要，那么就用compile<br>//如果你的jar包/依赖代码 仅在编译的时候需要，但是在运行时不需要依赖,就用provided</p>
<p>抓捕内存,cpu一段时间的运行结果,分析<br>方法时钟<br>截手机图<br>navigation editor和xcode的storyboard是一样的没用的,自动生成代码的<br>制作宏,类似与ps的动作,edit macros</p>
<p>华为规范:<br>操作符前后有空格<br>大括号另起一行</p>
<p>开始养成所有的习惯:<br>1.对自己的代码进行单元测试<br>2.代码重构,写高质量的代码</p>
<p>getParent().requestDisallowInterceptTouchEvent(true);//屏蔽父控件拦截onTouch事件<br>极光推送切换账号的问题：<br>只设置alias不设置tag</p>
<p>3.125 设置图片比例<br>首页轮播图尺寸比例设置为1:3.125<br>高度可以自适应，但比例要知道<br>radio设置大一些高度就会低一些</p>
<p>zoomsdk修改，复制一模一样的包命出来，改类，同时删掉jar包中的类<br>osc用git配置，2句命令，生成ssh添加到网站，可以替代<br>ssh-keygen -t rsa -C “xxxxx@xxxxx.com<br>cat ~/.ssh/id_rsa.pub 或者文件查看 添加到网站里面</p>
<p>调试：add watch<br>快速调试<br>所有断点<br>手动添加<br>sdk添加网站<br>模拟器插件配置</p>
<p>快键<br>智能提示 ctrl+space base<br>去除无用包 c s o<br>常用结构语句 c a t，选中后包围<br>全局搜索 c s r 工程里面查找 类似 c e<br>重写方法 c o 父类的方法</p>
<p>arraylist异步，线程不安全，vector同步<br>集合使用迭代器<br>迭代输出的时候不能操作list删除增加</p>
<p>cal.settime,gettime,add-2,setKV<br>让HeaderView不可点击mListView.addHeaderView(headView ,null,false);  </p>
<p>Drawable drawable= getResources().getDrawable(img[i]);<br>drawable.setBounds(0, 0, drawable.getMinimumWidth(), drawable.getMinimumHeight());<br>mTextView.setCompoundDrawables(drawable,null,null,null);<br>mTextView.setCompoundDrawablePadding(10);</p>
<p>@BindString(R.string.title) String title;<br>@BindDrawable(R.drawable.graphic) Drawable graphic;<br>@BindColor(R.color.red) int red;<br>@BindDimen(R.dimen.spacer) Float spacer; </p>
<p>@Bind({ R.id.first_name, R.id.middle_name, R.id.last_name })<br>List<edittext> nameViews;</edittext></p>
<p>ButterKnife.apply(nameViews, DISABLE);<br>ButterKnife.apply(nameViews, ENABLED, false);</p>
<p>这里用的反射，所以混淆的时候不要混淆SmileUtils这个类<br>Class clz = Class.forName(“project.chat.util.SmileUtils”);</p>
<p>快捷数组转List： new ArrayList<string>(Arrays.asList(“alias1”, “alias2”, “alias3”))<br>webview的loadData方法乱码的解决：webView.loadData(aVoid,”text/html;charset=UTF-8”,null);<br>测试的时候可以用textview的append方法，就像stringbuffer一样；<br>checkbox还有个toggle方法，省的自己去考虑逻辑；</string></p>
<p>代码设置drawable<br>Drawable drawable= getResources().getDrawable(img[i]);<br>drawable.setBounds(0, 0, drawable.getMinimumWidth(), drawable.getMinimumHeight());<br>mTextView.setCompoundDrawables(drawable,null,null,null);<br>mTextView.setCompoundDrawablePadding(10);</p>
<p>自定义PopupWindow，其实和自定义dialog是一样的<br>public class PopupSetting extends PopupWindow {<br>            private View mMenuView;<br>            public PopupSetting(Activity context, OnClickListener itemsOnClick) {<br>                super(context);<br>                //传入布局并找id<br>                mMenuView = LayoutInflater.from(context).inflate(R.layout.popup_setting, null);<br>                //button_update = (Button) mMenuView.findViewById(R.id.button_update);<br>                // button_update.setOnClickListener(itemsOnClick);<br>                setContentView(mMenuView);<br>                setHeight(LayoutParams.WRAP_CONTENT);<br>                //这是我针对平板做了一个适配，方法不是系统的<br>                if (DeviceUtil.isPad(context) &amp;&amp; DeviceUtil.isLandscape(context)) {<br>                    setWidth((int) (DeviceUtil.getWidth(context) * 0.3));<br>                } else {<br>                    setWidth(LayoutParams.MATCH_PARENT);<br>                }<br>                setFocusable(true);<br>                setAnimationStyle(R.style.popup_anim);<br>                setBackgroundDrawable(context.getResources().getDrawable(R.color.popup));<br>                // mMenuView添加OnTouchListener监听判断获取触屏位置如果在选择框外面则销毁弹出框<br>                mMenuView.setOnTouchListener(new OnTouchListener() {<br>                    public boolean onTouch(View v, MotionEvent event) {<br>                        int height = mMenuView.findViewById(R.id.pop_layout).getTop();<br>                        int y = (int) event.getY();<br>                        if (event.getAction() == MotionEvent.ACTION_UP) {<br>                            if (y &lt; height) {<br>                                dismiss();<br>                            }<br>                        }<br>                        return true;<br>                    }<br>                });<br>            }</p>
<pre><code>        private final OnClickListener itemsOnClick = new OnClickListener() {
            public void onClick(View v) {
                menuWindow.dismiss();
                menuWindow = new PopupSetting(this, itemsOnClick);
                if (DeviceUtil.isPad(NavigationActivity.this)
                        &amp;&amp; DeviceUtil.isLandscape(NavigationActivity.this)) {
                    menuWindow.showAtLocation(v.findViewById(R.id.group_setting),
                            Gravity.BOTTOM | Gravity.LEFT, 0, 0);
                } else {
                    menuWindow.showAtLocation(v.findViewById(R.id.group_setting),
                            Gravity.BOTTOM | Gravity.CENTER_HORIZONTAL, 0, 0);
                }
}
</code></pre><p>为了兼容低版本加的：</p>
<p><uses-sdk tools:overridelibrary="com.androidadvance.topsnackbar"><br>mItemList.toArray(new String[mItemList.size()])</uses-sdk></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/28/技术整理/安卓学习/" data-id="cjajd03ql000xdwlls8zsbmtz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-技术整理/新系统适配" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/28/技术整理/新系统适配/" class="article-date">
  <time datetime="2017-11-28T08:26:16.000Z" itemprop="datePublished">2017-11-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>加入白名单<br>权限适配<br>桌面快捷方式</p>
<p>// 在Android 6.0及以上系统，若定制手机使用到doze模式，请求将应用添加到白名单。<br>if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) {<br>    String packageName = trackApp.getPackageName();<br>    boolean isIgnoring = powerManager.isIgnoringBatteryOptimizations(packageName);<br>    if (!isIgnoring) {<br>        Intent intent = new Intent(<br>Settings.ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS);<br>        intent.setData(Uri.parse(“package:” + packageName));<br>        try {<br>            startActivity(intent);<br>        } catch (Exception ex) {<br>            ex.printStackTrace();<br>        }<br>    }<br>}</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/28/技术整理/新系统适配/" data-id="cjajd03ql000ydwll4sxzba3q" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-技术整理/源码学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/28/技术整理/源码学习/" class="article-date">
  <time datetime="2017-11-28T08:26:16.000Z" itemprop="datePublished">2017-11-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>源码</p>
<p>binder：ipc rpc 共享内存<br>实名binder是系统的binder</p>
<p>word count.</p>
<p>String s = “This is a book. There is a chair. Today is Monday. I’m going to school soon. There are teachers at school”;</p>
<p>a 2<br>book 1<br>chair 1<br>….<br>school 2<br>…</p>
<p>public static void printWordCount(String s) {<br>      Map<string,integer> result=new HashMap<string,integer> ;<br>      StringBuilder temp=new StringBuilder();</string,integer></string,integer></p>
<pre><code>for(int i=0;i&lt;s.length;i++){
    char c=s.index(i);
    if(c==&apos;!&apos;||c==&apos; &apos;||c==&apos;,&apos;||c==&apos;.&apos;||c==&apos;?&apos;||c==&apos;:&apos;||c==&apos;;&apos;||i==s.length-1){
        Integer x=(Integer) result.get(temp.toLowerCase()); 
        reslut.put(temp.toString().toLowerCase(),x+1);
        temp.setLength(0);
    }
    else{
        temp.append(c);
    }      
}

Set&lt;String&gt; set=result.keySet();
 // sort by alphabatical
Iterator l=set.iterator();
while(l.hasNext()){
   System.out.println(l.next()+&quot;  &quot; +result.get(l.next())));
}
</code></pre><p>}</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/28/技术整理/源码学习/" data-id="cjajd03qm000zdwlly9tebmys" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-技术整理/算法题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/28/技术整理/算法题/" class="article-date">
  <time datetime="2017-11-28T08:26:16.000Z" itemprop="datePublished">2017-11-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>阿拉丁<br>1.实现一个栈(包含方法push，pop)，要求提供一个max方法，求出栈中最大的元素，时间复杂度为O(1);<br>2.实现两个大数(用字符串表示的大数字)的减法</p>
<p>百度<br>3.不借助变量实现2个数交换</p>
<p>人工智能<br>4.实现数学组合数</p>
<p>今日头条<br>5.excel列26进制问题</p>
<p>昆仑万维<br>6.给一个字符串，求出单词的个数<br>7.实现一个Graph的clone方法</p>
<p>iHandy<br>8.讲一个整形数字转换为字符数组</p>
<p>9.</p>
<p>美团<br>创建对象的方式，有new，反射，clone</p>
<p>1.(搜狐)手写一个二分查找算法<br>这是一道送分题，但是需要注意手写的时候不要出一些关键字拼写错误和语法错误，如括号不匹配，大小写部分等；<br>2.(今日头条)Excel表格中列1对应的是A，列26对应Z，列27对应AA，列52对应AZ，列53对应BA，以此类推，随意给你一个数，把列名算出来；<br>3.(小红书)给你一个字符串，统计出各个单词的个数，比如”Today I have to go to school to study English”，输出格式要求按照a-z的顺序输出</p>
<p>English 1<br>go  1<br>have  1<br>I   1<br>school  1<br>study  1<br>to  3<br>Today  1</p>
<p>  //静态的内部类<br>        TestClass.Inner1 inner1 = new Inner1();  //和普通的顶层类new的方法一样<br>        inner1.report();</p>
<pre><code>//普通内部成员类
TestClass tc = new TestClass();
TestClass.Inner2 inner2 = tc.new Inner2();    //注意这里的使用方式
inner2.report();
</code></pre><p>ConcurrentHashMap是线程安全的hashmap</p>
<p>由此可见，每个进程都维护了自己的一份Sharepreference副本，在其运行过程中，与其他进程完全没有关系，只有应用结束时，才会将自己的修改持久化到文件系统中。</p>
<p>sqllite是同步的，不支持多进程</p>
<p>4<em>4的格子放4个棋子，列举<br>4</em>4格子 1230 0123 这两个是一样的</p>
<p>提高Android应用进程存活率新方法<br><a href="http://ouapi.com/" target="_blank" rel="noopener">http://ouapi.com/</a><br><a href="http://www.json.cn/" target="_blank" rel="noopener">http://www.json.cn/</a><br>115.28.230.86:3000/cmx/douxing_wiki/wiki/_pages<br><a href="http://xiangyu.5i5j.com/houseForPc/getHouseInitList?flag=0" target="_blank" rel="noopener">http://xiangyu.5i5j.com/houseForPc/getHouseInitList?flag=0</a><br><a href="https://www.nowcoder.com/" target="_blank" rel="noopener">https://www.nowcoder.com/</a><br>自己涨薪，了解工资<br>高工资 涨薪 快上市的公司美团小米<br>20+<br>已上市和没上市的<br>看板 排期<br>还有济南来到这里的东西</p>
<p>bugtag管理bug<br>bugly<br>友盟的统计，设备指数<br>安装包缩减<br>代码重构mvp<br>单条刷新<br>clean架构</p>
<p>tower<br>bugtag<br>蒲公英<br>在线http测试<br><a href="http://115.28.230.86:3000/cmx/douxing_android.git" target="_blank" rel="noopener">http://115.28.230.86:3000/cmx/douxing_android.git</a><br>115.28.230.86 douxing.com<br>115.28.230.86 ops.douxing.com<br>115.28.230.86 down.mworking.cn</p>
<p>flidder<br>反编译和抓第三方软件的包</p>
<p>贝壳金控了解到热修复，用过但不了解<br>泛型，rxjava，retrofit，动画插值器和估值器<br>handler<br>框架 eventbus dragger<br>美团打包<br>第三方登录 分享<br>jvm gcroot 内存管理<br>java底层<br>hashmap<br>反射注解<br>java内存管理<br>SparseArray<br>数据结构和算法<br>对象引用<br>运算符<br>内存管理<br>下载大文件<br>hasp的时间复杂度<br>hashcode equals<br>搜狗二面：<br>lru cache table 双链表<br>postinvalute<br>事件<br>fragment周期 act联动<br>aikit 三个重复 2个 半年定级 广度宽度<br>美团面试：<br>打包，多渠道，签名原理，contentprovider的一个崩溃<br>小公司业务写多了，接触不到这些东西，专门研究技术<br>二面深度不够<br>view层级，leank原理，lint原理，ui效果<br>组件化 fragment的生命周期方法<br>推送，直播输入窗<br>插件化loader<br>dexloader<br>链表的逆向<br>二分代码<br>排序代码<br>singletask的模式 aff<br>为什么多进程<br>service存活率<br>service的flag  destroy重启<br>枚举 bitmap压缩<br>actioncacle<br>down的时候存了一下，记下target，target!=null事件分发<br>内部类<br>双重锁<br>handler，单例<br>插件 学习rxjava retrofit mvp c++ kotlon<br>app架构设计 clean<br>插件化 组件化<br>热修复<br>写新闻 数据库图片缓存  leakcanary<br>用到了英文版<br>多渠道打包<br>缓存<br>单条刷新</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/28/技术整理/算法题/" data-id="cjajd03qn0010dwllyiwf25j3" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-技术整理/高级知识" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/28/技术整理/高级知识/" class="article-date">
  <time datetime="2017-11-28T08:26:16.000Z" itemprop="datePublished">2017-11-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>findViewById 控件树中以深度优先遍历<br>每个activity有一个window对象，他将一个decorview作为根view，内容是id为content的framelayout<br>操作window的方法在setcontentview前</p>
<p>测量模式<br>exactly 具体数值和matchparent<br>at_most 是wrapcontent<br>onMeasure只支持exactly模式，所以想要适应自定义view的wrapcontent属性需要重写该方法<br>重写onMeasure方法就是为了给wrap_content指定一个默认大小，不指定就是match_parent了<br>在preview里面构建完也能看到<br>measureSpec既包含了测量模式又包含了测量大小</p>
<p>viewgroup把view放在什么位置要重写onLayout方法，需要支持wrapcontent还需要onMeasure，viewgroup不需要绘制，但调用dispatchDraw调用子view的绘制方法</p>
<p>自定义view需要ondraw，onMeasure，和attr</p>
<p>attr用下划线分隔，用完要回收<br>TypedArray a = context.obtainStyledAttributes(R.styleable.Gallery1);int itemBackground = a.getDrawable(R.styleable.Gallery1_android_galleryItemBackground, 0);  a.recycle();</p>
<p>自定义一个actionbar需要先声明attr，然后提供事件监听，隐藏显示，动态改变文字，在xml中写一个固定布局通过include使用</p>
<p>//设置文字居中显示paint3.setTextAlign(Paint.Align.CENTER);</p>
<p>//这个获取屏幕宽高的方法不用activityDisplayMetrics displayMetrics = getResources().getDisplayMetrics();Log.e(“tag”, displayMetrics.widthPixels + “ , “ + displayMetrics.heightPixels);<br>获取android左上角的坐标，getRawXY，getLocationOnSreen<br>获取android相对于父容器左上角的坐标，getXY</p>
<p>事件拦截：<br>ABC，ab是viewgroup，c是view<br>a的dispatchTouchEvent<br>a的onInterceptTouchEvent<br>b的dispatchTouchEvent<br>b的onInterceptTouchEvent<br>c的dispatchTouchEvent<br>c的onTouchEvent<br>b的onTouchEvent<br>a的onTouchEvent</p>
<p>true拦截，false不拦截<br>c要是拦截了就不往上报了</p>
<p>第一行代码看的太快，没有消化完</p>
<p>xhdpi是720p 1dp=2px<br>xxhdpi是1080p 1dp=3px</p>
<p>drawarc可以画弧和扇形，空实心由style控制，2者由usercenter控制<br>layer-list实现ps图层</p>
<p>不支持横屏，每个activity设置属性，禁止旋转<br>onpause要暂停音视频，来电话，多窗口就不行，并且记录播放的位置，继续播放<br>mediaPlayer.pause<br>mediaPlayer.getCurrentPosition<br>mediaPlayer.seekTo(pos)<br>mediaPlayer.start</p>
<p>onDestroy<br>if(mediaPlayer!=null){<br>mediaPlayer.release;<br>mediaPlayer=null;<br>}</p>
<p>intent传递bitmap，大数据0.5M以下才能传过去</p>
<p>singleTop自己启动自己栈顶只调用onNewIntent<br>singleTask也是一样，同时会把他之上的activity全部finish</p>
<p>singleTop和singleTask还是有区别的，后者会把他以上的栈元素都清空</p>
<p>targetVersion小于23就可以不适配权限，compile使用23</p>
<p>proguard不光是混淆，还是精简资源，剔除无用的类</p>
<p>布局优化：<br>gpu过度绘制，增大蓝色，减少红色<br>view树<br>xml中使用viewstub<br>viewstub是延迟加载，调用visiable和inflate时加载出来他就没了，适合网络加载的那种布局</p>
<p>内存优化一般是堆优化：<br>bitmap：图片大小和尺寸处理</p>
<p>adb命令<br>安装 adb install -r /Users/feifei/Downloads/com.delphicoder.flud.apk<br>传输  push pull<br>pm和am命令，要先进shell<br>am start -n com.badou.mworking/com.badou.mworking.model.login.Splashs<br>reboot</p>
<p>刘的技能：</p>
<p>输入命令行，提交git<br>adb安装卸载app<br>分公司构建项目<br>打包aar避免每次构建<br>抓包调试网络<br>窗口view调试器</p>
<p>aligin属性算margin和padding<br>AdapterView获取某个位置的view<br>安卓原生的面包屑fragmentbreadcrumbs<br>viewswitcher2个view间的动画<br>pagerTabStrip是支持库里就有的<br>fragment.setRetainInstance(true);activity重建时仍然保留fragment<br>fragmentTransaction.commitAllowingStateLoss()activity保存状态后还可以提交<br>supportvx表示支持到apix以下<br>annotation告诉调用者期望的参数<br>mipmap只放icon就行了<br>xml引用9patch开启抖动<br>levellist如电量图片，xml中指定maxlevel和对应图片<br>clipdrawable适合进度条裁剪，通过setlevel<br>viewportwidth是看到他的窗口尺寸，和h5一样</p>
<p>vectordrawable是使用path用svg的<br>带动画的矢量drawable<br>创建属性动画，android:propertyName=”pathData”</p>
<p>rippledrawable动画开启了一个线程<br>Reveal动画都是md</p>
<p>设计一个app现在xml中定义全局尺寸，文字颜色<br>定义导航结构，使用materialdesign</p>
<p>这种写法android:textAppearance=”?android:attr/textAppearanceMedium”</p>
<p>viewpager和tablayout绑定起来<br>抽屉导航一开始打开抽屉给用户提示</p>
<p>选择主色调和强调色<br>文字选择字体，大小，间距，对齐，内容多少的变化<br>用图一定要设计图片，质量，大小，显示方式和很重要，图文混排的阅读性：给文字加背景或给图加遮罩，或局部<br>文字区域使用一个模糊的渐变<br>视觉设计：为什么要加模糊效果<br>给xxhdpi设计一套图就行</p>
<p>gridview的clipToPadding设为false</p>
<p>使用toolbar，设置透明，主题去掉actionbar<br>actionBar.setDisplayHomeAsUpEnabled(true);actionBar.setDisplayShowTitleEnabled(false);</p>
<p>属性动画没有指定初始值需要get方法<br>playSequentially依次播放动画</p>
<p>带scrollview的表单错误提示使用smoothScrollTo(0,y)来提示用户<br>textInputLayout.setError(“请输入”)；<br>textInputLayout.setErrorEnable(false);</p>
<p>Scene动画要求id一样，他会找2个场景中那些view是一样的<br>ViewGroup  mSceneRoot = (ViewGroup) findViewById(R.id.scene_root);Scene mScene1 = Scene.getSceneForLayout(mSceneRoot, R.layout.scene1, this);Scene mScene2 = Scene.getSceneForLayout(mSceneRoot, R.layout.scene2, this);<br>Transition mTransition = new ChangeBounds();mTransition.setDuration(DateUtils.SECOND_IN_MILLIS);mTransition.setInterpolator(new AccelerateDecelerateInterpolator());TransitionManager.go(mScene1);Scene mCurrentScene = mScene1;</p>
<p>TransitionManager.go(mScene2, mTransition);mCurrentScene = mScene2;</p>
<p>矢量图标和动画<br>Reveal动画很好创建的，勾股定理算出半径包含边长</p>
<p>图片的矩阵过滤器，合成模式实现淡化效果</p>
<p>自定义view保存和恢复状态<br>invalidate是个一步方法，只是往记录里面添加了一条<br>viewgroup设置setWillNotDraw可以不绘制自己</p>
<p>xml设置id，代码可以用，可以设置tag，用在map里<br>电量使用levellist来写，其中写maxlevel<br>transitondrawable过渡动画<br>insetdrawable加个padding<br>clipdrawable裁剪<br>scaledrawable往小缩</p>
<p>tintmode就是合成模式</p>
<p>使用图片的设计：<br>列表都有图放左边，有的有则放右边，简书<br>文字图片叠加需要遮罩</p>
<p>tools是告诉as的 tools:background<br>在自己声明的方法里使用@stringRes表名需要一个string的int<br>也可以@intDef来定义一个注解，实现枚举的效果</p>
<p>toolbar和drawer关联，不用ActionBarDrawerToggle<br>toolbar.setNavigationIcon(R.drawable.ic_menu_manage);toolbar.setNavigationOnClickListener(new View.OnClickListener() {    @Override    public void onClick(View view) {        drawer.openDrawer(GravityCompat.START);    }});</p>
<p>只想要一个返回按钮的toolbar，设置不显示title并开启导航，背景为透明<br>自定义evaluator的时候要考虑到逼近器会小于0或大于1<br>anticipateInterpolator 弹弓<br>cycleInterpolator 循环<br>overshoot  bounce path</p>
<p>keyframe动画<br>表单提示 smoothScrollTo<br>viewgroup的动画，和xml中加一句话自动产生动画<br>scene用来模拟场景，比如话剧<br>过渡动画使用延迟</p>
<p>自定义一个imageview，内部实现压缩和缓存</p>
<p>为什么说复用很重要，因为申请内存是要连续的，频繁gc会很卡的<br>所以有线程池，这些东西</p>
<p>listview的viewholder作为内部静态类使用就行了<br>文字过度绘制：<br>activity的背景，根布局的背景，list的背景，item的背景</p>
<p>控制垃圾回收：不要在ondraw，onlayout方法里new对象，房子啊构造函数里</p>
<p>HW有view的属性，渲染时间，可以导出为psd这个功能好，程序员可以在ps里设计</p>
<p>自定义drawable获取高度就是textsize<br>itemdecoration的ondrawover是在前景绘制，可以添加多个装饰，getiItemOffsets可以修改view的位置</p>
<p>低版本没有tint方法可以用setColorMatrix设置<br>不变的变量写final更快</p>
<p>invalidate是异步的，记录需要重绘<br>后台线程更新调用postInvalidate</p>
<p>setWillNotDraw()，比如viewgroup调用这个方法<br>保存和恢复状态，继承basesavedstate<br>canvas.drawBitmap(bitmap, 0, 0, paint);表示从左上角开始绘制所有东西<br>space这个控件挺好用的，类似margin</p>
<p>setSystemUiVisivility来控制全屏弱光等模式</p>
<p>wakelock保持屏幕常亮需要权限和释放<br>getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);<br>getWindow().clearFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);</p>
<p>//判断是否为ui线程<br>if (Looper.myLooper()==Looper.getMainLooper()){}</p>
<p>key可以用hashcode来做，equal就是比较hashcode<br>自定义的viewgroup根布局使用merge就好</p>
<p>attr中的枚举enum和flag</p>
<p>measure代码模板<br> public int measureDimension(int defualtSize,int measureSpec){<br>        int result=defualtSize;<br>       int specMode=MeasureSpec.getMode(measureSpec);<br>       int specSize=MeasureSpec.getSize(measureSpec);  </p>
<pre><code>   //1,layout中自定义组件给出来确定的值，比如100dp  
   //2,layout中自定义组件使用的是match_parent，但父控件的size已经可以确定了，比如设置的具体的值或者match_parent  
  if(specMode==MeasureSpec.EXACTLY){  
        result=specSize;  
   }  
    //layout中自定义组件使用的wrap_content  
    else if(specMode==MeasureSpec.AT_MOST){  
       result=Math.min(defualtSize,specSize);//建议：result不能大于specSize  
    }  
   //UNSPECIFIED,没有任何限制，所以可以设置任何大小  
   else {  
       result=defualtSize;  
    }  
    return result;  
}  
</code></pre><p>通过改变bitmap来使view重绘</p>
<p>ondraw分系统绘制前后</p>
<p>listview取消滚动条<br>listSelector=“@color/transparent” 取消选中状态<br>setSelection(pos)<br>平滑就是 smoothScrollToPosition(pos)</p>
<p>listview实现ios弹性效果只需要修改overScrollBy中的maxOverScrollY值<br>scrollBy在viewGroup中是移动子view，view里是移动内容<br>((View) getParent()).scrollBy(-offsetX, -offsetY);<br>负参数向坐标轴正方向移动，正数向负方向移动</p>
<p>public void computeScroll() {<br>    super.computeScroll();<br>    //是否完成滑动，false说明完成<br>    if (scroller.computeScrollOffset()) {<br>        ((View) getParent()).scrollTo(scroller.getCurrX(), scroller.getCurrY());<br>        //通过重绘来不断调用computeScroll<br>        invalidate();<br>    }<br>}</p>
<p>case MotionEvent.ACTION_UP:<br>    //实现松手后回到原点，scrollTo和scrollBy都是瞬间变化的，没有动画<br>    View v = ((View) getParent());<br>    scroller.startScroll(v.getScrollX(), v.getScrollY(), -v.getScrollX(),-v.getScrollY(), 2000);<br>    invalidate();<br>    break;</p>
<p>canvas save相当于新建图层，restore是合并图层，rotate就像画时钟一样，translate就像移动到圆心一样，只是个辅助绘图工具</p>
<p>图像矩阵rgba和偏移量<br>图像处理有使用hsb的api和矩阵api和像素点api<br>一些效果其实就是常用的矩阵了</p>
<p>bitmap的矩阵变换，一个3*3的矩阵来控制变换<br>translate<br>scale<br>skew<br>rotate<br>也有矩阵的高级api用</p>
<p>矩阵的set会重置，pre和post就不会，前乘和后乘<br>像素块的矩阵处理，drawBitmapMesh，verts计算横纵坐标值<br>通常用srcin和dstin做遮罩，srcin类似做一个圆角图片，实现矢量路径蒙版效果，dstin实现刮刮乐，图片上刷一层渐变的效果</p>
<p>通过合成模式和shader都能实现圆角效果<br>BitmapShader配合一个圆效果就有了</p>
<p>动画也是通过矩阵来实现的，自定义动画就需要实现这个方法<br>path动画其实就是个位移动画，5个图片的</p>
<p>使用camera做动画，rotateY就可以实现3d的效果</p>
<p>protected void applyTransformation(<br>        float interpolatedTime,<br>        Transformation t) {<br>    final Matrix matrix = t.getMatrix();<br>    mCamera.save();<br>    // 使用Camera设置旋转的角度<br>    mCamera.rotateY(mRotateY * interpolatedTime);<br>    // 将旋转变换作用到matrix上<br>    mCamera.getMatrix(matrix);<br>    mCamera.restore();<br>    // 通过pre方法设置矩阵作用前的偏移量来改变旋转中心<br>    matrix.preTranslate(mCenterWidth, mCenterHeight);<br>    matrix.postTranslate(-mCenterWidth, -mCenterHeight);<br>}</p>
<p>singleTop用于比如接受QQ消息的界面<br>singleTask把另一个后台栈都移到前台了<br>singleTop和singleInstance的startActivityForResult会返回cancel，不同的task不能传递数据<br>调用flag on history就不会入栈，直接消失<br>在mainfest可以配置clearTaskOnLaunch是清除其他的act，finishOnTaskLaunch是清除自己</p>
<p>android.os.Build获取系统信息<br>ActivityInfo是manifest下的Activity和receiver<br>ServiceInfo和ApplicationInfo<br>resolveinfo是封装intent信息的</p>
<p>pm = this.getPackageManager();<br>// 获取应用信息<br>List<applicationinfo> listAppcations = pm.getInstalledApplications(PackageManager.GET_UNINSTALLED_PACKAGES);<br>系统应用 if ((app.flags &amp; ApplicationInfo.FLAG_SYSTEM) != 0)<br>第三方应用 if ((app.flags &amp; ApplicationInfo.FLAG_SYSTEM) &lt;= 0)<br> if ((app.flags &amp;ApplicationInfo.FLAG_UPDATED_SYSTEM_APP) != 0)  系统应用升级后成第三方<br>SD卡应用 if ((app.flags &amp; ApplicationInfo.FLAG_EXTERNAL_STORAGE) != 0)</applicationinfo></p>
<p>am获取进程，内存信息，运行的程序和服务<br>MemoryInfo，RunningAppProcessInfo，RunningServiceInfo</p>
<p>List<activitymanager.runningappprocessinfo> appProcessList =<br>        mActivityManager.getRunningAppProcesses();<br>int pid = info.pid;<br>int uid = info.uid;<br>String processName = info.processName;<br>int[] memoryPid = new int[]{pid};<br>Debug.MemoryInfo[] memoryInfo = mActivityManager<br>        .getProcessMemoryInfo(memoryPid);<br>int memorySize = memoryInfo[0].getTotalPss();</activitymanager.runningappprocessinfo></p>
<p>apktools就是一个b和d命令<br>反编译，汉化，重新打包<br>16ms内不丢帧就不会卡顿</p>
<p>gpu柱状图保持在绿线以下，布局边界，过度绘制<br>Relative和merge减少层级</p>
<p>通用ui块把宽高设置为0，这样include的时候自己设置宽高</p>
<p>栈存放基本数据和引用，堆存放对象和数组，通过gc控制<br>bitmap：使用适当的分辨率和大小，及时回收或复用，使用缓存<br>列表使用小图，详情用大图</p>
<p>内存包括寄存器，栈堆，静态存储区域，常量池</p>
<p>静态方法比普通方法快，减少不必要的成员变量和对象，少用枚举和迭代器<br>receiver和传感器的创建销毁，注册解注册<br>使用renderscript和opengl实现复杂绘图</p>
<p>Monitor视图：内存持续增高可能是内存泄漏，内存抖动，突然减少可能是发生了GC</p>
<p>getActionBar().setBackgroundDrawable();<br>//给状态栏设置颜色<br>window.setStatusBarColor();</p>
<p>Z=elevation+translationZ;<br>setTranslationZ来改变阴影效果，做动画<br>tintMode有add，multiply</p>
<p>ripple一种是写个包装的shape，一种是<br>background=“?android:attr/selectableItemBackground”  波纹有界<br>background=“?android:attr/selectableItemBackgroundBorderless” 波纹越界<br>clickable先设置为true</p>
<p>新的Activity转场动画，第一个这么写<br>startActivity(intent,ActivityOptions.makeSceneTransitionAnimation(this).toBundle());<br>第二个就需要<br>getWindow().requestFeature(Window.FEATURE_CONTENT_TRANSITIONS);</p>
<pre><code>getWindow().setEnterTransition(new Explode());
getWindow().setEnterTransition(new Slide());
getWindow().setEnterTransition(new Fade());
getWindow().setExitTransition(new Fade());
</code></pre><p>共享动画<br>startActivity(intent,ActivityOptions.makeSceneTransitionAnimation(this,<br>                // 创建多个共享元素<br>                Pair.create(view, “share”),<br>                Pair.create(fab, “fab”)).toBundle());</p>
<p>reveal动画一个是中心动画，一个是边界动画(0,0)</p>
<p>点击之后阴影上浮，然后下去的动画</p>
<p>stateListAnimator在selector里面写动画</p>
<selector xmlns:android="http://schemas.android.com/apk/res/android"><br><br>    <item android:state_pressed="true"><br>        <set><br>            <objectanimator android:duration="1000" android:propertyname="rotationX" android:valueto="360" android:valuetype="floatType"><br>        </objectanimator></set><br>    </item><br><br>    <item android:state_pressed="false"><br>        <set><br>            <objectanimator android:duration="1000" android:propertyname="rotationX" android:valueto="0" android:valuetype="floatType"><br>        </objectanimator></set><br>    </item><br></selector>

<p>app:actionViewClass=”android.support.v7.widget.SearchView”<br>app:actionProviderClass=”android.support.v7.widget.ShareActionProvider”</p>
<p>展开和折叠式通知需要借助2个RemoteView，设置为contentView和bigContentView<br>悬挂式弹窗就是一个横幅的展示通知给 build.setFullScreenIntent(pendingIntent, true);<br>显示等级默认public，private是没锁屏才显示，sercet是没有安全锁才显示build.setvisibility</p>
<p>build.setColor</p>
<p>下载进度条，progress.setMax(conn.getContentLength)<br>byte[] buffer =new byte[1024]<br>(len=is.read(buffer))!=-1<br>fos.write(buffer,0,len)</p>
<p>只需要找到相应行为的intent就会写了<br>sim卡变更，每次读取手机seri号或者uiid，不一致就是变更了设备<br>监听重启的广播需要重启权限</p>
<p>通过AM获取RunningServices来判断服务是否在运行<br>程序锁创建了一个服务，死循环里获取顶部的Activity，然后进程休眠<br>am.getRunningTasks(1).get(0).topActivity.getPackageName()<br>然后在程序锁的界面里和服务绑定，停止监控，其实就是加入了一个list而已，一个是程序锁列表，一个是已经通过密码进入的列表</p>
<p>ContentObserver可以观察到变化，不是只查询一次，而之前数据库的操作都换成Provider<br>让密码锁界面不出现在历史记录栈中，同时设置为singleInstance</p>
<p>锁屏后就停止保护了，这是需要一个广播，清空已通过保护应用</p>
<p>短信拦截就是广播，abortBroadCast，同时清除数据库记录<br>tm监听动画，挂断电话endCall需要反射了，清除数据要用到provider的观察者了</p>
<p>listview比如做一个系统和用户2个header就可以通过position来生成view，2个list<br>pos==0  pos&lt;=list1.size()  pos==list1.size()+1<br>这2个view就不能复用了</p>
<p>popwindows一定要设置背景<br>卸载应用只是一个intent</p>
<p>流量也是可以控制的<br>获取packageInfo，筛选出权限含有网络的，取出uid来获取流量信息</p>
<p>代码审核<br>checkstyle优化<br>vm绑定<br>日志库<br>上午说的代码提交 命名 设计 性能<br>todo mvp<br>react native</p>
<p>206<br>301 302<br>地图<br>线程停止 手指缩放 自写底层</p>
<p>事件传递不太一样<br>场景动画<br>注解  库 枚举 多个注解<br>colorres和colorint<br>线程注解 值范围注解 权限 重写 返回值 测试 keep注解</p>
<p>java注解在运行时才是反射<br>实现process<br>apt辅助或者provided</p>
<p>百分比布局<br>arm64v8a兼容v7a<br>ndk单独做一个model<br>使用低sdk的来编译so文件，minsdk，否则低版本装不上<br>全平台abi<br>gradle通用配置</p>
<p>第三方aar引用，全局配置指定目录<br>jcenter上传自己的库，在线引用<br>builder变种 final private static<br>innerbuilder插件dialog imageloader okhttp</p>
<p>anr到桌面，分析原因<br>开启严格模式避免anr debug<br>blockcanary集成</p>
<p>handlerthread还是没搞明白<br>asynctask和线程池<br>loader异步加载数据</p>
<p>数据库敏感相息加密<br>sp加解密</p>
<p>4.2后，方法上加上注解就行<br>4.2以下使用jsprompt通过string传输json通信，定义类方法名，发射调用<br>mvp sdk开发<br>eventbus 组建通信</p>
<p>日志库 文件和网络<br>json库  fastjson logansquare<br>greendao  realm<br>库的重复模块</p>
<p>64k是个bug<br>降低方法<br>第三方库选用评估</p>
<p>开发时aar加速 multidex加速 min21<br>pul和push</p>
<p>webp支持  4.2支持透明<br>转换工具<br>png转9patch<br>过滤<br>资源混淆<br>执行命令行<br>crash获取命令行</p>
<p>rx函数式编程<br>buttrrknife绑定资源<br>对所有view进行set和action操作 属性</p>
<p>系统服务<br>依赖注入 创建对象 构造函数 dagger2<br>kotlin  anko布局<br>reactnative</p>
<p>nuwa热修复 bugly<br>aop aspectj</p>
<p>buck构建</p>
<p>sparsearray代替hashmap<br>二分查找<br>静态内部类handler</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/28/技术整理/高级知识/" data-id="cjajd03qq0013dwllpib5f3fa" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-My-New-Post" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/28/My-New-Post/" class="article-date">
  <time datetime="2017-11-28T08:20:05.000Z" itemprop="datePublished">2017-11-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/28/My-New-Post/">My New Post</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/28/My-New-Post/" data-id="cjajd03pe0007dwllhfi9icrc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/28/hello-world/" class="article-date">
  <time datetime="2017-11-28T08:06:28.788Z" itemprop="datePublished">2017-11-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/28/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/11/28/hello-world/" data-id="cjajd03ph000adwll8d0r0chx" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/3/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/11/28/监听GPS和网络的广播/">(no title)</a>
          </li>
        
          <li>
            <a href="/2017/11/28/2月来学习总结/">(no title)</a>
          </li>
        
          <li>
            <a href="/2017/11/28/Android从细节提升用户体验/">(no title)</a>
          </li>
        
          <li>
            <a href="/2017/11/28/Html和Android简单对比/">(no title)</a>
          </li>
        
          <li>
            <a href="/2017/11/28/Mac配置ADB/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>